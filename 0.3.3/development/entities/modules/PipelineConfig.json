{
  "title": "PipelineConfig",
  "description": "A class to hold the configuration for a [PipelineModule][kiara.pipeline.module.PipelineModule].\n\nIf you want to control the pipeline input and output names, you need to have to provide a map that uses the\nautogenerated field name ([step_id]__[field_name] -- 2 underscores!!) as key, and the desired field name\nas value. The reason that schema for the autogenerated field names exist is that it's hard to ensure\nthe uniqueness of each field; some steps can have the same input field names, but will need different input\nvalues. In some cases, some inputs of different steps need the same input. Those sorts of things.\nSo, to make sure that we always use the right values, I chose to implement a conservative default approach,\naccepting that in some cases the user will be prompted for duplicate inputs for the same value.\n\nTo remedy that, the pipeline creator has the option to manually specify a mapping to rename some or all of\nthe input/output fields.\n\nFurther, because in a lot of cases there won't be any overlapping fields, the creator can specify ``auto``,\nin which case *Kiara* will automatically create a mapping that tries to map autogenerated field names\nto the shortest possible names for each case.\n\nExamples:\n\n    Configuration for a pipeline module that functions as a ``nand`` logic gate (in Python):\n\n    ``` python\n    and_step = PipelineStepConfig(module_type=\"and\", step_id=\"and\")\n    not_step = PipelineStepConfig(module_type=\"not\", step_id=\"not\", input_links={\"a\": [\"and.y\"]}\n    nand_p_conf = PipelineConfig(doc=\"Returns 'False' if both inputs are 'True'.\",\n                        steps=[and_step, not_step],\n                        input_aliases={\n                            \"and__a\": \"a\",\n                            \"and__b\": \"b\"\n                        },\n                        output_aliases={\n                            \"not__y\": \"y\"\n                        }}\n    ```\n\n    Or, the same thing in json:\n\n    ``` json\n    {\n      \"module_type_name\": \"nand\",\n      \"doc\": \"Returns 'False' if both inputs are 'True'.\",\n      \"steps\": [\n        {\n          \"module_type\": \"and\",\n          \"step_id\": \"and\"\n        },\n        {\n          \"module_type\": \"not\",\n          \"step_id\": \"not\",\n          \"input_links\": {\n            \"a\": \"and.y\"\n          }\n        }\n      ],\n      \"input_aliases\": {\n        \"and__a\": \"a\",\n        \"and__b\": \"b\"\n      },\n      \"output_aliases\": {\n        \"not__y\": \"y\"\n      }\n    }\n    ```",
  "type": "object",
  "properties": {
    "constants": {
      "title": "Constants",
      "description": "Value constants for this module.",
      "type": "object"
    },
    "defaults": {
      "title": "Defaults",
      "description": "Value defaults for this module.",
      "type": "object"
    },
    "steps": {
      "title": "Steps",
      "description": "A list of steps/modules of this pipeline, and their connections.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PipelineStepConfig"
      }
    },
    "input_aliases": {
      "title": "Input Aliases",
      "description": "A map of input aliases, with the calculated (<step_id>__<input_name> -- double underscore!) name as key, and a string (the resulting workflow input alias) as value. Check the documentation for the config class for which marker strings can be used to automatically create this map if possible.",
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      ]
    },
    "output_aliases": {
      "title": "Output Aliases",
      "description": "A map of output aliases, with the calculated (<step_id>__<output_name> -- double underscore!) name as key, and a string (the resulting workflow output alias) as value.  Check the documentation for the config class for which marker strings can be used to automatically create this map if possible.",
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      ]
    },
    "documentation": {
      "title": "Documentation",
      "description": "Documentation about what the pipeline does.",
      "default": "-- n/a --",
      "type": "string"
    },
    "context": {
      "title": "Context",
      "description": "Metadata for this workflow.",
      "type": "object"
    }
  },
  "definitions": {
    "DocumentationMetadataModel": {
      "title": "DocumentationMetadataModel",
      "description": "Base class for classes that represent value metadata in kiara.",
      "type": "object",
      "properties": {
        "description": {
          "title": "Description",
          "description": "Short description of the item.",
          "default": "-- n/a --",
          "type": "string"
        },
        "doc": {
          "title": "Doc",
          "description": "Detailed documentation of the item (in markdown).",
          "type": "string"
        }
      }
    },
    "StepValueAddress": {
      "title": "StepValueAddress",
      "description": "Small model to describe the address of a value of a step, within a Pipeline/PipelineStructure.",
      "type": "object",
      "properties": {
        "step_id": {
          "title": "Step Id",
          "description": "The id of a step within a pipeline.",
          "type": "string"
        },
        "value_name": {
          "title": "Value Name",
          "description": "The name of the value (output name or pipeline input name).",
          "type": "string"
        },
        "sub_value": {
          "title": "Sub Value",
          "description": "A reference to a subitem of a value (e.g. column, list item)",
          "type": "object"
        }
      },
      "required": [
        "step_id",
        "value_name"
      ],
      "additionalProperties": false
    },
    "PipelineStepConfig": {
      "title": "PipelineStepConfig",
      "description": "A class to hold the configuration of one module within a [PipelineModule][kiara.pipeline.module.PipelineModule].",
      "type": "object",
      "properties": {
        "module_type": {
          "title": "Module Type",
          "description": "The module type.",
          "type": "string"
        },
        "module_config": {
          "title": "Module Config",
          "description": "The configuration for the module.",
          "type": "object"
        },
        "doc": {
          "title": "Doc",
          "description": "Documentation for this operation.",
          "allOf": [
            {
              "$ref": "#/definitions/DocumentationMetadataModel"
            }
          ]
        },
        "step_id": {
          "title": "Step Id",
          "description": "The id of the step.",
          "type": "string"
        },
        "input_links": {
          "title": "Input Links",
          "description": "The map with the name of an input link as key, and the connected module output name(s) as value.",
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/StepValueAddress"
            }
          }
        }
      },
      "required": [
        "module_type",
        "step_id"
      ],
      "additionalProperties": false
    }
  }
}