
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Kiara project">
      
      
        <meta name="author" content="Markus Binsteiner">
      
      
        <link rel="canonical" href="https://dharpa.org/kiara/latest/reference/kiara/utils/__init__/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>utils - Kiara</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kiara.utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Kiara" class="md-header__button md-logo" aria-label="Kiara" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kiara
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              utils
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/DHARPA-Project/kiara" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Kiara" class="md-nav__button md-logo" aria-label="Kiara" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Kiara
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DHARPA-Project/kiara" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Included components
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Included components" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Included components
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../included_components/" class="md-nav__link">
        Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../included_components/data_types/" class="md-nav__link">
        data_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../included_components/module_types/" class="md-nav__link">
        module_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../included_components/kiara_model_types/" class="md-nav__link">
        kiara_model_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../included_components/operation_types/" class="md-nav__link">
        operation_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../included_components/operations/" class="md-nav__link">
        operations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          API reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../__init__/">kiara</a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="kiara" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          kiara
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_1" type="checkbox" id="__nav_3_1_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../context/__init__/">context</a>
          
            <label for="__nav_3_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="context" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_1">
          <span class="md-nav__icon md-icon"></span>
          context
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../context/config/" class="md-nav__link">
        config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../context/orm/" class="md-nav__link">
        orm
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_2" type="checkbox" id="__nav_3_1_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../data_types/__init__/">data_types</a>
          
            <label for="__nav_3_1_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="data_types" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          data_types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_2_1" type="checkbox" id="__nav_3_1_2_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../data_types/included_core_types/__init__/">included_core_types</a>
          
            <label for="__nav_3_1_2_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="included_core_types" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_2_1">
          <span class="md-nav__icon md-icon"></span>
          included_core_types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_types/included_core_types/filesystem/" class="md-nav__link">
        filesystem
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_2_1_2" type="checkbox" id="__nav_3_1_2_1_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../data_types/included_core_types/internal/__init__/">internal</a>
          
            <label for="__nav_3_1_2_1_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="internal" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_2_1_2">
          <span class="md-nav__icon md-icon"></span>
          internal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_types/included_core_types/internal/render_value/" class="md-nav__link">
        render_value
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_types/included_core_types/serialization/" class="md-nav__link">
        serialization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../defaults/" class="md-nav__link">
        defaults
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4" type="checkbox" id="__nav_3_1_4" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../doc/__init__/">doc</a>
          
            <label for="__nav_3_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="doc" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_4">
          <span class="md-nav__icon md-icon"></span>
          doc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/gen_info_pages/" class="md-nav__link">
        gen_info_pages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/generate_api_doc/" class="md-nav__link">
        generate_api_doc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/mkdocs_macros_cli/" class="md-nav__link">
        mkdocs_macros_cli
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/mkdocs_macros_kiara/" class="md-nav__link">
        mkdocs_macros_kiara
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4_5" type="checkbox" id="__nav_3_1_4_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../doc/mkdocstrings/__init__/">mkdocstrings</a>
          
            <label for="__nav_3_1_4_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="mkdocstrings" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_4_5">
          <span class="md-nav__icon md-icon"></span>
          mkdocstrings
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/mkdocstrings/collector/" class="md-nav__link">
        collector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/mkdocstrings/handler/" class="md-nav__link">
        handler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/mkdocstrings/renderer/" class="md-nav__link">
        renderer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6" type="checkbox" id="__nav_3_1_6" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/__init__/">interfaces</a>
          
            <label for="__nav_3_1_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="interfaces" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_6">
          <span class="md-nav__icon md-icon"></span>
          interfaces
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1" type="checkbox" id="__nav_3_1_6_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/__init__/">cli</a>
          
            <label for="__nav_3_1_6_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="cli" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_6_1">
          <span class="md-nav__icon md-icon"></span>
          cli
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_1" type="checkbox" id="__nav_3_1_6_1_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/context/__init__/">context</a>
          
            <label for="__nav_3_1_6_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="context" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_1">
          <span class="md-nav__icon md-icon"></span>
          context
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/context/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_2" type="checkbox" id="__nav_3_1_6_1_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/data/__init__/">data</a>
          
            <label for="__nav_3_1_6_1_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="data" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_2">
          <span class="md-nav__icon md-icon"></span>
          data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/data/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_3" type="checkbox" id="__nav_3_1_6_1_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/dev/__init__/">dev</a>
          
            <label for="__nav_3_1_6_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="dev" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_3">
          <span class="md-nav__icon md-icon"></span>
          dev
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/dev/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_4" type="checkbox" id="__nav_3_1_6_1_4" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/module/__init__/">module</a>
          
            <label for="__nav_3_1_6_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="module" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_4">
          <span class="md-nav__icon md-icon"></span>
          module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/module/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_5" type="checkbox" id="__nav_3_1_6_1_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/operation/__init__/">operation</a>
          
            <label for="__nav_3_1_6_1_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="operation" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_5">
          <span class="md-nav__icon md-icon"></span>
          operation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/operation/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_6" type="checkbox" id="__nav_3_1_6_1_6" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/pipeline/__init__/">pipeline</a>
          
            <label for="__nav_3_1_6_1_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="pipeline" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_6">
          <span class="md-nav__icon md-icon"></span>
          pipeline
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/pipeline/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_7" type="checkbox" id="__nav_3_1_6_1_7" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/render/__init__/">render</a>
          
            <label for="__nav_3_1_6_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="render" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_7">
          <span class="md-nav__icon md-icon"></span>
          render
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/render/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/run/" class="md-nav__link">
        run
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_9" type="checkbox" id="__nav_3_1_6_1_9" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/service/__init__/">service</a>
          
            <label for="__nav_3_1_6_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="service" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_9">
          <span class="md-nav__icon md-icon"></span>
          service
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/service/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_10" type="checkbox" id="__nav_3_1_6_1_10" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/type/__init__/">type</a>
          
            <label for="__nav_3_1_6_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="type" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_10">
          <span class="md-nav__icon md-icon"></span>
          type
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/type/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_1_11" type="checkbox" id="__nav_3_1_6_1_11" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/cli/workflow/__init__/">workflow</a>
          
            <label for="__nav_3_1_6_1_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="workflow" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_6_1_11">
          <span class="md-nav__icon md-icon"></span>
          workflow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/cli/workflow/commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_2" type="checkbox" id="__nav_3_1_6_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/python_api/__init__/">python_api</a>
          
            <label for="__nav_3_1_6_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="python_api" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_6_2">
          <span class="md-nav__icon md-icon"></span>
          python_api
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/python_api/batch/" class="md-nav__link">
        batch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/python_api/operation/" class="md-nav__link">
        operation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/python_api/utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/python_api/value/" class="md-nav__link">
        value
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/python_api/workflow/" class="md-nav__link">
        workflow
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6_3" type="checkbox" id="__nav_3_1_6_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../interfaces/tui/__init__/">tui</a>
          
            <label for="__nav_3_1_6_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="tui" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_6_3">
          <span class="md-nav__icon md-icon"></span>
          tui
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/tui/pager/" class="md-nav__link">
        pager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7" type="checkbox" id="__nav_3_1_7" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/__init__/">models</a>
          
            <label for="__nav_3_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="models" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_7">
          <span class="md-nav__icon md-icon"></span>
          models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/aliases/__init__/" class="md-nav__link">
        aliases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/archives/" class="md-nav__link">
        archives
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/context/" class="md-nav__link">
        context
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/documentation/" class="md-nav__link">
        documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_5" type="checkbox" id="__nav_3_1_7_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/events/__init__/">events</a>
          
            <label for="__nav_3_1_7_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="events" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_7_5">
          <span class="md-nav__icon md-icon"></span>
          events
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/events/alias_registry/" class="md-nav__link">
        alias_registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/events/data_registry/" class="md-nav__link">
        data_registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/events/destiny_registry/" class="md-nav__link">
        destiny_registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/events/job_registry/" class="md-nav__link">
        job_registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/events/pipeline/" class="md-nav__link">
        pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/events/workflow_registry/" class="md-nav__link">
        workflow_registry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/filesystem/" class="md-nav__link">
        filesystem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/info/" class="md-nav__link">
        info
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_8" type="checkbox" id="__nav_3_1_7_8" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/module/__init__/">module</a>
          
            <label for="__nav_3_1_7_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="module" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_7_8">
          <span class="md-nav__icon md-icon"></span>
          module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/destiniy/" class="md-nav__link">
        destiniy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/jobs/" class="md-nav__link">
        jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/manifest/" class="md-nav__link">
        manifest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/operation/" class="md-nav__link">
        operation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/persistence/" class="md-nav__link">
        persistence
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_8_6" type="checkbox" id="__nav_3_1_7_8_6" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/module/pipeline/__init__/">pipeline</a>
          
            <label for="__nav_3_1_7_8_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="pipeline" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_7_8_6">
          <span class="md-nav__icon md-icon"></span>
          pipeline
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/pipeline/controller/" class="md-nav__link">
        controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/pipeline/pipeline/" class="md-nav__link">
        pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/pipeline/structure/" class="md-nav__link">
        structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/module/pipeline/value_refs/" class="md-nav__link">
        value_refs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/python_class/" class="md-nav__link">
        python_class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/render_value/__init__/" class="md-nav__link">
        render_value
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_11" type="checkbox" id="__nav_3_1_7_11" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/runtime_environment/__init__/">runtime_environment</a>
          
            <label for="__nav_3_1_7_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="runtime_environment" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_7_11">
          <span class="md-nav__icon md-icon"></span>
          runtime_environment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/runtime_environment/kiara/" class="md-nav__link">
        kiara
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/runtime_environment/operating_system/" class="md-nav__link">
        operating_system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/runtime_environment/python/" class="md-nav__link">
        python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_12" type="checkbox" id="__nav_3_1_7_12" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/values/__init__/">values</a>
          
            <label for="__nav_3_1_7_12">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="values" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_7_12">
          <span class="md-nav__icon md-icon"></span>
          values
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/values/data_type/" class="md-nav__link">
        data_type
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/values/info/" class="md-nav__link">
        info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/values/lineage/" class="md-nav__link">
        lineage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/values/value/" class="md-nav__link">
        value
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_12_5" type="checkbox" id="__nav_3_1_7_12_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/values/value_metadata/__init__/">value_metadata</a>
          
            <label for="__nav_3_1_7_12_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="value_metadata" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_7_12_5">
          <span class="md-nav__icon md-icon"></span>
          value_metadata
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/values/value_metadata/included_metadata_types/__init__/" class="md-nav__link">
        included_metadata_types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/values/value_schema/" class="md-nav__link">
        value_schema
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/workflow/" class="md-nav__link">
        workflow
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_8" type="checkbox" id="__nav_3_1_8" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../modules/__init__/">modules</a>
          
            <label for="__nav_3_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="modules" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_8">
          <span class="md-nav__icon md-icon"></span>
          modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_8_1" type="checkbox" id="__nav_3_1_8_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../modules/included_core_modules/__init__/">included_core_modules</a>
          
            <label for="__nav_3_1_8_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="included_core_modules" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_8_1">
          <span class="md-nav__icon md-icon"></span>
          included_core_modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/create_from/" class="md-nav__link">
        create_from
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/export_as/" class="md-nav__link">
        export_as
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/filesystem/" class="md-nav__link">
        filesystem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/metadata/" class="md-nav__link">
        metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/pipeline/" class="md-nav__link">
        pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/pretty_print/" class="md-nav__link">
        pretty_print
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/render_value/" class="md-nav__link">
        render_value
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/included_core_modules/serialization/" class="md-nav__link">
        serialization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_9" type="checkbox" id="__nav_3_1_9" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../operations/__init__/">operations</a>
          
            <label for="__nav_3_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="operations" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_9">
          <span class="md-nav__icon md-icon"></span>
          operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_9_1" type="checkbox" id="__nav_3_1_9_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../operations/included_core_operations/__init__/">included_core_operations</a>
          
            <label for="__nav_3_1_9_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="included_core_operations" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_9_1">
          <span class="md-nav__icon md-icon"></span>
          included_core_operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/create_from/" class="md-nav__link">
        create_from
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/export_as/" class="md-nav__link">
        export_as
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/metadata/" class="md-nav__link">
        metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/pipeline/" class="md-nav__link">
        pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/pretty_print/" class="md-nav__link">
        pretty_print
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/render_value/" class="md-nav__link">
        render_value
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/included_core_operations/serialize/" class="md-nav__link">
        serialize
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_10" type="checkbox" id="__nav_3_1_10" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../processing/__init__/">processing</a>
          
            <label for="__nav_3_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="processing" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_10">
          <span class="md-nav__icon md-icon"></span>
          processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../processing/synchronous/" class="md-nav__link">
        synchronous
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11" type="checkbox" id="__nav_3_1_11" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/__init__/">registries</a>
          
            <label for="__nav_3_1_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="registries" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_11">
          <span class="md-nav__icon md-icon"></span>
          registries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_1" type="checkbox" id="__nav_3_1_11_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/aliases/__init__/">aliases</a>
          
            <label for="__nav_3_1_11_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="aliases" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_1">
          <span class="md-nav__icon md-icon"></span>
          aliases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/aliases/archives/" class="md-nav__link">
        archives
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_2" type="checkbox" id="__nav_3_1_11_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/data/__init__/">data</a>
          
            <label for="__nav_3_1_11_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="data" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_2">
          <span class="md-nav__icon md-icon"></span>
          data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_2_1" type="checkbox" id="__nav_3_1_11_2_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/data/data_store/__init__/">data_store</a>
          
            <label for="__nav_3_1_11_2_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="data_store" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_11_2_1">
          <span class="md-nav__icon md-icon"></span>
          data_store
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/data/data_store/filesystem_store/" class="md-nav__link">
        filesystem_store
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_3" type="checkbox" id="__nav_3_1_11_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/destinies/__init__/">destinies</a>
          
            <label for="__nav_3_1_11_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="destinies" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_3">
          <span class="md-nav__icon md-icon"></span>
          destinies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/destinies/filesystem_store/" class="md-nav__link">
        filesystem_store
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/destinies/registry/" class="md-nav__link">
        registry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/environment/__init__/" class="md-nav__link">
        environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_5" type="checkbox" id="__nav_3_1_11_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/events/__init__/">events</a>
          
            <label for="__nav_3_1_11_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="events" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_5">
          <span class="md-nav__icon md-icon"></span>
          events
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/events/metadata/" class="md-nav__link">
        metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/events/registry/" class="md-nav__link">
        registry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/ids/__init__/" class="md-nav__link">
        ids
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_7" type="checkbox" id="__nav_3_1_11_7" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/jobs/__init__/">jobs</a>
          
            <label for="__nav_3_1_11_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="jobs" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_7">
          <span class="md-nav__icon md-icon"></span>
          jobs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_7_1" type="checkbox" id="__nav_3_1_11_7_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/jobs/job_store/__init__/">job_store</a>
          
            <label for="__nav_3_1_11_7_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="job_store" data-md-level="5">
        <label class="md-nav__title" for="__nav_3_1_11_7_1">
          <span class="md-nav__icon md-icon"></span>
          job_store
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/jobs/job_store/filesystem_store/" class="md-nav__link">
        filesystem_store
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/models/__init__/" class="md-nav__link">
        models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/modules/__init__/" class="md-nav__link">
        modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/operations/__init__/" class="md-nav__link">
        operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/types/__init__/" class="md-nav__link">
        types
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_12" type="checkbox" id="__nav_3_1_11_12" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../registries/workflows/__init__/">workflows</a>
          
            <label for="__nav_3_1_11_12">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="workflows" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_12">
          <span class="md-nav__icon md-icon"></span>
          workflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../registries/workflows/archives/" class="md-nav__link">
        archives
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_12" type="checkbox" id="__nav_3_1_12" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../render/__init__/">render</a>
          
            <label for="__nav_3_1_12">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="render" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_12">
          <span class="md-nav__icon md-icon"></span>
          render
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../render/pipeline/" class="md-nav__link">
        pipeline
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_13" type="checkbox" id="__nav_3_1_13" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">utils</a>
          
            <label for="__nav_3_1_13">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="utils" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_13">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../class_loading/" class="md-nav__link">
        class_loading
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_13_2" type="checkbox" id="__nav_3_1_13_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../cli/__init__/">cli</a>
          
            <label for="__nav_3_1_13_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="cli" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_13_2">
          <span class="md-nav__icon md-icon"></span>
          cli
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli/rich_click/" class="md-nav__link">
        rich_click
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concurrency/" class="md-nav__link">
        concurrency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../db/" class="md-nav__link">
        db
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../debug/" class="md-nav__link">
        debug
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../doc/" class="md-nav__link">
        doc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../global_metadata/" class="md-nav__link">
        global_metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graphs/" class="md-nav__link">
        graphs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hashfs/__init__/" class="md-nav__link">
        hashfs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hashing/" class="md-nav__link">
        hashing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jupyter/" class="md-nav__link">
        jupyter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../metadata/" class="md-nav__link">
        metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../operations/" class="md-nav__link">
        operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../output/" class="md-nav__link">
        output
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/" class="md-nav__link">
        pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string_vars/" class="md-nav__link">
        string_vars
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../values/" class="md-nav__link">
        values
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kiara.utils" class="md-nav__link">
    kiara.utils
  </a>
  
    <nav class="md-nav" aria-label="kiara.utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara.utils.CAMEL_TO_SNAKE_REGEX" class="md-nav__link">
    CAMEL_TO_SNAKE_REGEX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.SUBCLASS_TYPE" class="md-nav__link">
    SUBCLASS_TYPE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.WORD_REGEX_PATTERN" class="md-nav__link">
    WORD_REGEX_PATTERN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.logger" class="md-nav__link">
    logger
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.string_types" class="md-nav__link">
    string_types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.yaml" class="md-nav__link">
    yaml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.StringYAML" class="md-nav__link">
    StringYAML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara.utils-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara.utils.camel_case_to_snake_case" class="md-nav__link">
    camel_case_to_snake_case()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.check_valid_field_names" class="md-nav__link">
    check_valid_field_names()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.create_valid_identifier" class="md-nav__link">
    create_valid_identifier()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.dict_from_cli_args" class="md-nav__link">
    dict_from_cli_args()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.find_free_id" class="md-nav__link">
    find_free_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.first_line" class="md-nav__link">
    first_line()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.get_auto_workflow_alias" class="md-nav__link">
    get_auto_workflow_alias()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.get_data_from_file" class="md-nav__link">
    get_data_from_file()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.is_debug" class="md-nav__link">
    is_debug()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.is_develop" class="md-nav__link">
    is_develop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.is_jupyter" class="md-nav__link">
    is_jupyter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.is_rich_renderable" class="md-nav__link">
    is_rich_renderable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.log_exception" class="md-nav__link">
    log_exception()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.log_message" class="md-nav__link">
    log_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.merge_dicts" class="md-nav__link">
    merge_dicts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.orjson_dumps" class="md-nav__link">
    orjson_dumps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.to_camel_case" class="md-nav__link">
    to_camel_case()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara.utils-modules" class="md-nav__link">
    Modules
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara.utils.class_loading" class="md-nav__link">
    class_loading
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.cli" class="md-nav__link">
    cli
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.concurrency" class="md-nav__link">
    concurrency
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.data" class="md-nav__link">
    data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.db" class="md-nav__link">
    db
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.debug" class="md-nav__link">
    debug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.doc" class="md-nav__link">
    doc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.global_metadata" class="md-nav__link">
    global_metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.graphs" class="md-nav__link">
    graphs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.hashfs" class="md-nav__link">
    hashfs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.hashing" class="md-nav__link">
    hashing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.jupyter" class="md-nav__link">
    jupyter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.metadata" class="md-nav__link">
    metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.models" class="md-nav__link">
    models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.operations" class="md-nav__link">
    operations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.output" class="md-nav__link">
    output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.pipelines" class="md-nav__link">
    pipelines
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.string_vars" class="md-nav__link">
    string_vars
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara.utils.values" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/DHARPA-Project/kiara/edit/master/docs/src/kiara/utils/__init__.py" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>utils</h1>

<div class="doc doc-object doc-module">

<a id="kiara.utils"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="kiara.utils.CAMEL_TO_SNAKE_REGEX" class="doc doc-heading">
<code class="highlight language-python"><span class="n">CAMEL_TO_SNAKE_REGEX</span></code>


<a href="#kiara.utils.CAMEL_TO_SNAKE_REGEX" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="kiara.utils.SUBCLASS_TYPE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">SUBCLASS_TYPE</span></code>


<a href="#kiara.utils.SUBCLASS_TYPE" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="kiara.utils.WORD_REGEX_PATTERN" class="doc doc-heading">
<code class="highlight language-python"><span class="n">WORD_REGEX_PATTERN</span></code>


<a href="#kiara.utils.WORD_REGEX_PATTERN" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="kiara.utils.logger" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logger</span></code>


<a href="#kiara.utils.logger" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="kiara.utils.string_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">string_types</span></code>


<a href="#kiara.utils.string_types" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="kiara.utils.yaml" class="doc doc-heading">
<code class="highlight language-python"><span class="n">yaml</span></code>


<a href="#kiara.utils.yaml" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h3 id="kiara.utils.StringYAML" class="doc doc-heading">
        <code>
StringYAML            (<span title="ruamel.yaml.main.YAML">YAML</span>)
        </code>



<a href="#kiara.utils.StringYAML" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">StringYAML</span><span class="p">(</span><span class="n">YAML</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">inefficient</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">stream</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">inefficient</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">YAML</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inefficient</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="kiara.utils.StringYAML.dump" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></code>


<a href="#kiara.utils.StringYAML.dump" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">inefficient</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">stream</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">inefficient</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
    <span class="n">YAML</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inefficient</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>


<h2 id="kiara.utils-functions">Functions<a href="#kiara.utils-functions" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.camel_case_to_snake_case" class="doc doc-heading">
<code class="highlight language-python"><span class="n">camel_case_to_snake_case</span><span class="p">(</span><span class="n">camel_text</span><span class="p">,</span> <span class="n">repl</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span></code>


<a href="#kiara.utils.camel_case_to_snake_case" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">camel_case_to_snake_case</span><span class="p">(</span><span class="n">camel_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">repl</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">CAMEL_TO_SNAKE_REGEX</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">camel_text</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.check_valid_field_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_valid_field_names</span><span class="p">(</span><span class="o">*</span><span class="n">field_names</span><span class="p">)</span></code>


<a href="#kiara.utils.check_valid_field_names" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Check whether the provided field names are all valid.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>an iterable of strings with invalid field names</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_valid_field_names</span><span class="p">(</span><span class="o">*</span><span class="n">field_names</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Check whether the provided field names are all valid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        an iterable of strings with invalid field names</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">field_names</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">INVALID_VALUE_NAMES</span> <span class="ow">or</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.create_valid_identifier" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_valid_identifier</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>


<a href="#kiara.utils.create_valid_identifier" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_valid_identifier</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">slugify</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.dict_from_cli_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dict_from_cli_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">list_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.dict_from_cli_args" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dict_from_cli_args</span><span class="p">(</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">list_keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_v</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">_v</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">part_config</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">_v</span><span class="p">}</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">arg</span><span class="p">))):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
            <span class="n">part_config</span> <span class="o">=</span> <span class="n">get_data_from_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">part_config</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">part_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">part_config</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not parse argument into data: </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">list_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">list_keys</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">part_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">list_keys</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;duplicate.key&quot;</span><span class="p">,</span> <span class="n">old_value</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">new_value</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
                <span class="n">config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">return</span> <span class="n">config</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.find_free_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_free_id</span><span class="p">(</span><span class="n">stem</span><span class="p">,</span> <span class="n">current_ids</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span></code>


<a href="#kiara.utils.find_free_id" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Find a free var (or other name) based on a stem string, based on a list of provided existing names.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>stem</code></td>
        <td><code>str</code></td>
        <td><p>the base string to use</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>current_ids</code></td>
        <td><code>Iterable[str]</code></td>
        <td><p>currently existing names</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>method</code></td>
        <td><code>str</code></td>
        <td><p>the method to create new names (allowed: 'count' -- for now)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>method_args</code></td>
        <td><code>dict</code></td>
        <td><p>prototing_config for the creation method</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>a free name</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_free_id</span><span class="p">(</span>
    <span class="n">stem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">current_ids</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Find a free var (or other name) based on a stem string, based on a list of provided existing names.</span>

<span class="sd">    Args:</span>
<span class="sd">        stem (str): the base string to use</span>
<span class="sd">        current_ids (Iterable[str]): currently existing names</span>
<span class="sd">        method (str): the method to create new names (allowed: &#39;count&#39; -- for now)</span>
<span class="sd">        method_args (dict): prototing_config for the creation method</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: a free name</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_count</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">stem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_ids</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">stem</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">start_count</span>

    <span class="c1"># new_name = None</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">new_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stem</span><span class="si">}{</span><span class="n">sep</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="n">current_ids</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">break</span>
    <span class="k">return</span> <span class="n">new_name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.first_line" class="doc doc-heading">
<code class="highlight language-python"><span class="n">first_line</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>


<a href="#kiara.utils.first_line" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">first_line</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

    <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.get_auto_workflow_alias" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_auto_workflow_alias</span><span class="p">(</span><span class="n">module_type</span><span class="p">,</span> <span class="n">use_incremental_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.get_auto_workflow_alias" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return an id for a workflow obj of a provided module class.</p>
<p>If 'use_incremental_ids' is set to True, a unique id is returned.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>module_type</code></td>
        <td><code>str</code></td>
        <td><p>the name of the module type</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>use_incremental_ids</code></td>
        <td><code>bool</code></td>
        <td><p>whether to return a unique (incremental) id</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>a module id</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_auto_workflow_alias</span><span class="p">(</span><span class="n">module_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">use_incremental_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return an id for a workflow obj of a provided module class.</span>

<span class="sd">    If &#39;use_incremental_ids&#39; is set to True, a unique id is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        module_type (str): the name of the module type</span>
<span class="sd">        use_incremental_ids (bool): whether to return a unique (incremental) id</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: a module id</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_incremental_ids</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">module_type</span>

    <span class="n">nr</span> <span class="o">=</span> <span class="n">_AUTO_MODULE_ID</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">module_type</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">_AUTO_MODULE_ID</span><span class="p">[</span><span class="n">module_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">nr</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">module_type</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">nr</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.get_data_from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data_from_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.get_data_from_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_data_from_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">content_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">content_type</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">content_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;yaml&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="n">content_type</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span>
        <span class="k">elif</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yml&quot;</span><span class="p">):</span>
            <span class="n">content_type</span> <span class="o">=</span> <span class="s2">&quot;yaml&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid data format, only &#39;json&#39; or &#39;yaml&#39; are supported currently.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.is_debug" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_debug</span><span class="p">()</span></code>


<a href="#kiara.utils.is_debug" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_debug</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

    <span class="n">debug</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debug</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.is_develop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_develop</span><span class="p">()</span></code>


<a href="#kiara.utils.is_develop" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_develop</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

    <span class="n">debug</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DEVELOP&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debug</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.is_jupyter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_jupyter</span><span class="p">()</span></code>


<a href="#kiara.utils.is_jupyter" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_jupyter</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

    <span class="k">return</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span> <span class="ow">or</span> <span class="s2">&quot;jupyter_client&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.is_rich_renderable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_rich_renderable</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>


<a href="#kiara.utils.is_rich_renderable" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_rich_renderable</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">ConsoleRenderable</span><span class="p">,</span> <span class="n">RichCast</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.log_exception" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log_exception</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span></code>


<a href="#kiara.utils.log_exception" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">log_exception</span><span class="p">(</span><span class="n">exc</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
        <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.log_message" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span></code>


<a href="#kiara.utils.log_message" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">log_message</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># else:</span>
    <span class="c1">#     logger.debug(msg, **data)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.merge_dicts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_dicts</span><span class="p">(</span><span class="o">*</span><span class="n">dicts</span><span class="p">)</span></code>


<a href="#kiara.utils.merge_dicts" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">merge_dicts</span><span class="p">(</span><span class="o">*</span><span class="n">dicts</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">dicts</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="n">current</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dicts</span><span class="p">:</span>
        <span class="n">dpath</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">current</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.orjson_dumps" class="doc doc-heading">
<code class="highlight language-python"><span class="n">orjson_dumps</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span></code>


<a href="#kiara.utils.orjson_dumps" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">orjson_dumps</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># orjson.dumps returns bytes, to match standard json.dumps we need to decode</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">orjson</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error dumping json data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">kiara</span> <span class="kn">import</span> <span class="n">dbg</span>

            <span class="n">dbg</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">e</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="kiara.utils.to_camel_case" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_camel_case</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>


<a href="#kiara.utils.to_camel_case" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_camel_case</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

    <span class="n">words</span> <span class="o">=</span> <span class="n">WORD_REGEX_PATTERN</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



<h2 id="kiara.utils-modules">Modules<a href="#kiara.utils-modules" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.class_loading" class="doc doc-heading">
        <code>class_loading</code>



<a href="#kiara.utils.class_loading" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.class_loading.KiaraEntryPointItem" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KiaraEntryPointItem</span></code>


<a href="#kiara.utils.class_loading.KiaraEntryPointItem" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.class_loading.KiaraEntryPointIterable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KiaraEntryPointIterable</span></code>


<a href="#kiara.utils.class_loading.KiaraEntryPointIterable" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.class_loading.SUBCLASS_TYPE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">SUBCLASS_TYPE</span></code>


<a href="#kiara.utils.class_loading.SUBCLASS_TYPE" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.class_loading.logger" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logger</span></code>


<a href="#kiara.utils.class_loading.logger" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



<h4 id="kiara.utils.class_loading-functions">Functions<a href="#kiara.utils.class_loading-functions" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_archive_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_archive_types</span><span class="p">()</span></code>


<a href="#kiara.utils.class_loading.find_all_archive_types" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Find all <a class="autorefs autorefs-internal" href="../../registries/__init__/#kiara.registries.KiaraArchive">KiaraArchive</a> subclasses via package entry points.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_archive_types</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KiaraArchive&quot;</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Find all [KiaraArchive][kiara.registries.KiaraArchive] subclasses via package entry points.&quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">kiara.registries</span> <span class="kn">import</span> <span class="n">KiaraArchive</span>

    <span class="k">return</span> <span class="n">load_all_subclasses_for_entry_point</span><span class="p">(</span>
        <span class="n">entry_point_name</span><span class="o">=</span><span class="s2">&quot;kiara.archive_type&quot;</span><span class="p">,</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">KiaraArchive</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">type_id_key</span><span class="o">=</span><span class="s2">&quot;_archive_type_name&quot;</span><span class="p">,</span>
        <span class="n">type_id_func</span><span class="o">=</span><span class="n">_cls_name_id_func</span><span class="p">,</span>
        <span class="n">attach_python_metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_cli_subcommands" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_cli_subcommands</span><span class="p">()</span></code>


<a href="#kiara.utils.class_loading.find_all_cli_subcommands" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_cli_subcommands</span><span class="p">():</span>

    <span class="n">entry_point_name</span> <span class="o">=</span> <span class="s2">&quot;kiara.cli_subcommands&quot;</span>
    <span class="n">log2</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;stevedore&quot;</span><span class="p">)</span>
    <span class="n">out_hdlr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entry_point_name</span><span class="si">}</span><span class="s2"> plugin search message/error -&gt; %(message)s&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">log2</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">out_hdlr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
        <span class="n">log2</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">log2</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="n">log_message</span><span class="p">(</span><span class="s2">&quot;events.loading.entry_points&quot;</span><span class="p">,</span> <span class="n">entry_point_name</span><span class="o">=</span><span class="n">entry_point_name</span><span class="p">)</span>

    <span class="n">mgr</span> <span class="o">=</span> <span class="n">ExtensionManager</span><span class="p">(</span>
        <span class="n">namespace</span><span class="o">=</span><span class="n">entry_point_name</span><span class="p">,</span>
        <span class="n">invoke_on_load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">propagate_map_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span> <span class="k">for</span> <span class="n">plugin</span> <span class="ow">in</span> <span class="n">mgr</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_data_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_data_types</span><span class="p">()</span></code>


<a href="#kiara.utils.class_loading.find_all_data_types" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Find all [KiaraModule][kiara.module.KiaraModule] subclasses via package entry points.</p>
<p>TODO</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_data_types</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;DataType&quot;</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Find all [KiaraModule][kiara.module.KiaraModule] subclasses via package entry points.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">kiara.data_types</span> <span class="kn">import</span> <span class="n">DataType</span>

    <span class="n">all_data_types</span> <span class="o">=</span> <span class="n">load_all_subclasses_for_entry_point</span><span class="p">(</span>
        <span class="n">entry_point_name</span><span class="o">=</span><span class="s2">&quot;kiara.data_types&quot;</span><span class="p">,</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">DataType</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">type_id_key</span><span class="o">=</span><span class="s2">&quot;_data_type_name&quot;</span><span class="p">,</span>
        <span class="n">type_id_func</span><span class="o">=</span><span class="n">_cls_name_id_func</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">invalid</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data_types</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid value type name(s), type names can&#39;t contain &#39;.&#39;: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">invalid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">all_data_types</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_kiara_model_classes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_kiara_model_classes</span><span class="p">()</span></code>


<a href="#kiara.utils.class_loading.find_all_kiara_model_classes" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Find all [KiaraModule][kiara.module.KiaraModule] subclasses via package entry points.</p>
<p>TODO</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_kiara_model_classes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KiaraModel&quot;</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Find all [KiaraModule][kiara.module.KiaraModule] subclasses via package entry points.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">kiara.models</span> <span class="kn">import</span> <span class="n">KiaraModel</span>

    <span class="k">return</span> <span class="n">load_all_subclasses_for_entry_point</span><span class="p">(</span>
        <span class="n">entry_point_name</span><span class="o">=</span><span class="s2">&quot;kiara.model_classes&quot;</span><span class="p">,</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">KiaraModel</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">type_id_key</span><span class="o">=</span><span class="s2">&quot;_kiara_model_id&quot;</span><span class="p">,</span>
        <span class="n">type_id_func</span><span class="o">=</span><span class="n">_cls_name_id_func</span><span class="p">,</span>
        <span class="n">attach_python_metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_kiara_modules" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_kiara_modules</span><span class="p">()</span></code>


<a href="#kiara.utils.class_loading.find_all_kiara_modules" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Find all [KiaraModule][kiara.module.KiaraModule] subclasses via package entry points.</p>
<p>TODO</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_kiara_modules</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KiaraModule&quot;</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Find all [KiaraModule][kiara.module.KiaraModule] subclasses via package entry points.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">kiara.modules</span> <span class="kn">import</span> <span class="n">KiaraModule</span>

    <span class="n">modules</span> <span class="o">=</span> <span class="n">load_all_subclasses_for_entry_point</span><span class="p">(</span>
        <span class="n">entry_point_name</span><span class="o">=</span><span class="s2">&quot;kiara.modules&quot;</span><span class="p">,</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">KiaraModule</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">type_id_key</span><span class="o">=</span><span class="s2">&quot;_module_type_name&quot;</span><span class="p">,</span>
        <span class="n">attach_python_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># need to test this, since I couldn&#39;t add an abstract method to the KiaraModule class itself (mypy complained because it is potentially overloaded)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;process&quot;</span><span class="p">):</span>
            <span class="c1"># TODO: check signature of process method</span>
            <span class="n">log_message</span><span class="p">(</span><span class="s2">&quot;ignore.module.class&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;no &#39;process&#39; method&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_kiara_pipeline_paths" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_kiara_pipeline_paths</span><span class="p">(</span><span class="n">skip_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_all_kiara_pipeline_paths" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_kiara_pipeline_paths</span><span class="p">(</span>
    <span class="n">skip_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]:</span>

    <span class="kn">import</span> <span class="nn">logging</span>

    <span class="n">log2</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;stevedore&quot;</span><span class="p">)</span>
    <span class="n">out_hdlr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&quot;kiara pipeline search plugin error -&gt; </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">log2</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">out_hdlr</span><span class="p">)</span>
    <span class="n">log2</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="n">log_message</span><span class="p">(</span><span class="s2">&quot;events.loading.pipelines&quot;</span><span class="p">)</span>

    <span class="n">mgr</span> <span class="o">=</span> <span class="n">ExtensionManager</span><span class="p">(</span>
        <span class="n">namespace</span><span class="o">=</span><span class="s2">&quot;kiara.pipelines&quot;</span><span class="p">,</span> <span class="n">invoke_on_load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">propagate_map_exceptions</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">paths</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># TODO: make sure we load &#39;core&#39; first?</span>
    <span class="k">for</span> <span class="n">plugin</span> <span class="ow">in</span> <span class="n">mgr</span><span class="p">:</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span>
            <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">):</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

                <span class="n">f_args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">metadata</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">f_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">metadata</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;ignore.pipeline_lookup_arguments&quot;</span><span class="p">,</span>
                        <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;more than 2 arguments provided&quot;</span><span class="p">,</span>
                        <span class="n">surplus_args</span><span class="o">=</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">f_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="p">)</span>

                <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">f_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">paths</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="n">path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="n">paths</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
                    <span class="kn">import</span> <span class="nn">traceback</span>

                    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">skip_errors</span><span class="p">:</span>
                    <span class="n">log_message</span><span class="p">(</span>
                        <span class="s2">&quot;ignore.pipline_entrypoint&quot;</span><span class="p">,</span> <span class="n">entrypoint_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error trying to load plugin &#39;</span><span class="si">{</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">skip_errors</span><span class="p">:</span>
                <span class="n">log_message</span><span class="p">(</span>
                    <span class="s2">&quot;ignore.pipline_entrypoint&quot;</span><span class="p">,</span>
                    <span class="n">entrypoint_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;invalid plugin type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t load pipelines for entrypoint &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;: invalid plugin type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">paths</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_all_operation_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_all_operation_types</span><span class="p">()</span></code>


<a href="#kiara.utils.class_loading.find_all_operation_types" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_all_operation_types</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;OperationType&quot;</span><span class="p">]]:</span>

    <span class="kn">from</span> <span class="nn">kiara.operations</span> <span class="kn">import</span> <span class="n">OperationType</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">load_all_subclasses_for_entry_point</span><span class="p">(</span>
        <span class="n">entry_point_name</span><span class="o">=</span><span class="s2">&quot;kiara.operation_types&quot;</span><span class="p">,</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">OperationType</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">type_id_key</span><span class="o">=</span><span class="s2">&quot;_operation_type_name&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_data_types_under" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_data_types_under</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_data_types_under" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_data_types_under</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;DataType&quot;</span><span class="p">]]:</span>

    <span class="kn">from</span> <span class="nn">kiara.data_types</span> <span class="kn">import</span> <span class="n">DataType</span>

    <span class="k">return</span> <span class="n">find_subclasses_under</span><span class="p">(</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">DataType</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">python_module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_kiara_model_classes_under" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_kiara_model_classes_under</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_kiara_model_classes_under" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_kiara_model_classes_under</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KiaraModel&quot;</span><span class="p">]]:</span>

    <span class="kn">from</span> <span class="nn">kiara.models</span> <span class="kn">import</span> <span class="n">KiaraModel</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">find_subclasses_under</span><span class="p">(</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">KiaraModel</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">python_module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_kiara_modules_under" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_kiara_modules_under</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_kiara_modules_under" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_kiara_modules_under</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KiaraModule&quot;</span><span class="p">]]:</span>

    <span class="kn">from</span> <span class="nn">kiara.modules</span> <span class="kn">import</span> <span class="n">KiaraModule</span>

    <span class="k">return</span> <span class="n">find_subclasses_under</span><span class="p">(</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">KiaraModule</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">python_module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_operations_under" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_operations_under</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_operations_under" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_operations_under</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;OperationType&quot;</span><span class="p">]]:</span>

    <span class="kn">from</span> <span class="nn">kiara.operations</span> <span class="kn">import</span> <span class="n">OperationType</span>

    <span class="k">return</span> <span class="n">find_subclasses_under</span><span class="p">(</span>
        <span class="n">base_class</span><span class="o">=</span><span class="n">OperationType</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">python_module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_pipeline_base_path_for_module" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_pipeline_base_path_for_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_pipeline_base_path_for_module" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_pipeline_base_path_for_module</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s2">&quot;frozen&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Pyinstaller bundling not supported yet.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="n">module_file</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="vm">__file__</span>
    <span class="k">assert</span> <span class="n">module_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">module_file</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">:</span>
        <span class="n">log_message</span><span class="p">(</span><span class="s2">&quot;ignore.pipeline_folder&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;folder does not exist&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.find_subclasses_under" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_subclasses_under</span><span class="p">(</span><span class="n">base_class</span><span class="p">,</span> <span class="n">python_module</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.find_subclasses_under" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Find all (non-abstract) subclasses of a base class that live under a module (recursively).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>base_class</code></td>
        <td><code>Type[~SUBCLASS_TYPE]</code></td>
        <td><p>the parent class</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>python_module</code></td>
        <td><code>Union[str, module]</code></td>
        <td><p>the Python module to search</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Type[~SUBCLASS_TYPE]]</code></td>
      <td><p>a list of all subclasses</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_subclasses_under</span><span class="p">(</span>
    <span class="n">base_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">],</span>
    <span class="n">python_module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Find all (non-abstract) subclasses of a base class that live under a module (recursively).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        base_class: the parent class</span>
<span class="sd">        python_module: the Python module to search</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of all subclasses</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s2">&quot;frozen&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Pyinstaller bundling not supported yet.&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">python_module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">python_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">python_module</span><span class="p">)</span>

        <span class="n">_import_modules_recursively</span><span class="p">(</span><span class="n">python_module</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log_exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">log_message</span><span class="p">(</span><span class="s2">&quot;ignore.python_module&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">python_module</span><span class="p">),</span> <span class="n">reason</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">subclasses</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_get_all_subclasses</span><span class="p">(</span><span class="n">base_class</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="n">subclasses</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sc</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">python_module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.class_loading.load_all_subclasses_for_entry_point" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_all_subclasses_for_entry_point</span><span class="p">(</span><span class="n">entry_point_name</span><span class="p">,</span> <span class="n">base_class</span><span class="p">,</span> <span class="n">ignore_abstract_classes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">type_id_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_id_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_id_no_attach</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">attach_python_metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.class_loading.load_all_subclasses_for_entry_point" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Find all subclasses of a base class via package entry points.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>entry_point_name</code></td>
        <td><code>str</code></td>
        <td><p>the entry point name to query entries for</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>base_class</code></td>
        <td><code>Type[~SUBCLASS_TYPE]</code></td>
        <td><p>the base class to look for</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ignore_abstract_classes</code></td>
        <td><code>bool</code></td>
        <td><p>whether to include abstract classes in the result</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>type_id_key</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>if provided, the found classes will have their id attached as an attribute, using the value of this as the name. if an attribute of this name already exists, it will be used as id without further processing</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>type_id_func</code></td>
        <td><code>Callable</code></td>
        <td><p>a function to take the found class as input, and returns a string representing the id of the class. By default, the module path + "." + class name (snake-case) is used (minus the string 'kiara_modules.<project_name>'', if it exists at the beginning</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>type_id_no_attach</code></td>
        <td><code>bool</code></td>
        <td><p>in case you want to use the type_id_key to set the id, but don't want it attached to classes that don't have it, set this to true. In most cases, you won't need this option</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>attach_python_metadata</code></td>
        <td><code>Union[bool, str]</code></td>
        <td><p>whether to attach a <a class="autorefs autorefs-internal" href="../../models/python_class/#kiara.models.python_class.PythonClass">PythonClass</a> metadata model to the class. By default, '_python_class' is used as attribute name if this argument is 'True', If this argument is a string, that will be used as name instead.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/class_loading.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_all_subclasses_for_entry_point</span><span class="p">(</span>
    <span class="n">entry_point_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">base_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">],</span>
    <span class="n">ignore_abstract_classes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">type_id_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">type_id_func</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">type_id_no_attach</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">attach_python_metadata</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Find all subclasses of a base class via package entry points.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        entry_point_name: the entry point name to query entries for</span>
<span class="sd">        base_class: the base class to look for</span>
<span class="sd">        ignore_abstract_classes: whether to include abstract classes in the result</span>
<span class="sd">        type_id_key: if provided, the found classes will have their id attached as an attribute, using the value of this as the name. if an attribute of this name already exists, it will be used as id without further processing</span>
<span class="sd">        type_id_func: a function to take the found class as input, and returns a string representing the id of the class. By default, the module path + &quot;.&quot; + class name (snake-case) is used (minus the string &#39;kiara_modules.&lt;project_name&gt;&#39;&#39;, if it exists at the beginning</span>
<span class="sd">        type_id_no_attach: in case you want to use the type_id_key to set the id, but don&#39;t want it attached to classes that don&#39;t have it, set this to true. In most cases, you won&#39;t need this option</span>
<span class="sd">        attach_python_metadata: whether to attach a [PythonClass][kiara.models.python_class.PythonClass] metadata model to the class. By default, &#39;_python_class&#39; is used as attribute name if this argument is &#39;True&#39;, If this argument is a string, that will be used as name instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">log2</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;stevedore&quot;</span><span class="p">)</span>
    <span class="n">out_hdlr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entry_point_name</span><span class="si">}</span><span class="s2"> plugin search message/error -&gt; %(message)s&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">log2</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">out_hdlr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
        <span class="n">log2</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_hdlr</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">log2</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="n">log_message</span><span class="p">(</span><span class="s2">&quot;events.loading.entry_points&quot;</span><span class="p">,</span> <span class="n">entry_point_name</span><span class="o">=</span><span class="n">entry_point_name</span><span class="p">)</span>

    <span class="n">mgr</span> <span class="o">=</span> <span class="n">ExtensionManager</span><span class="p">(</span>
        <span class="n">namespace</span><span class="o">=</span><span class="n">entry_point_name</span><span class="p">,</span>
        <span class="n">invoke_on_load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">propagate_map_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">result_entrypoints</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">result_dynamic</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">SUBCLASS_TYPE</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">plugin</span> <span class="ow">in</span> <span class="n">mgr</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
            <span class="c1"># this means an actual (sub-)class was provided in the entrypoint</span>

            <span class="bp">cls</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base_class</span><span class="p">):</span>
                <span class="n">log_message</span><span class="p">(</span>
                    <span class="s2">&quot;ignore.entrypoint&quot;</span><span class="p">,</span>
                    <span class="n">entry_point</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">base_class</span><span class="o">=</span><span class="n">base_class</span><span class="p">,</span>
                    <span class="n">sub_class</span><span class="o">=</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">,</span>
                    <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Entry point reference not a subclass of &#39;</span><span class="si">{</span><span class="n">base_class</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">_process_subclass</span><span class="p">(</span>
                <span class="n">sub_class</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span>
                <span class="n">base_class</span><span class="o">=</span><span class="n">base_class</span><span class="p">,</span>
                <span class="n">type_id_key</span><span class="o">=</span><span class="n">type_id_key</span><span class="p">,</span>
                <span class="n">type_id_func</span><span class="o">=</span><span class="n">type_id_func</span><span class="p">,</span>
                <span class="n">type_id_no_attach</span><span class="o">=</span><span class="n">type_id_no_attach</span><span class="p">,</span>
                <span class="n">attach_python_metadata</span><span class="o">=</span><span class="n">attach_python_metadata</span><span class="p">,</span>
                <span class="n">ignore_abstract_classes</span><span class="o">=</span><span class="n">ignore_abstract_classes</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">result_entrypoints</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span>
            <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">):</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">classes</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_debug</span><span class="p">():</span>
                    <span class="kn">import</span> <span class="nn">traceback</span>

                    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error trying to load plugin &#39;</span><span class="si">{</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">sub_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
                <span class="n">type_id</span> <span class="o">=</span> <span class="n">_process_subclass</span><span class="p">(</span>
                    <span class="n">sub_class</span><span class="o">=</span><span class="n">sub_class</span><span class="p">,</span>
                    <span class="n">base_class</span><span class="o">=</span><span class="n">base_class</span><span class="p">,</span>
                    <span class="n">type_id_key</span><span class="o">=</span><span class="n">type_id_key</span><span class="p">,</span>
                    <span class="n">type_id_func</span><span class="o">=</span><span class="n">type_id_func</span><span class="p">,</span>
                    <span class="n">type_id_no_attach</span><span class="o">=</span><span class="n">type_id_no_attach</span><span class="p">,</span>
                    <span class="n">attach_python_metadata</span><span class="o">=</span><span class="n">attach_python_metadata</span><span class="p">,</span>
                    <span class="n">ignore_abstract_classes</span><span class="o">=</span><span class="n">ignore_abstract_classes</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">type_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">type_id</span> <span class="ow">in</span> <span class="n">result_dynamic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Duplicate type id &#39;</span><span class="si">{</span><span class="n">type_id</span><span class="si">}</span><span class="s2">&#39; for type </span><span class="si">{</span><span class="n">entry_point_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result_dynamic</span><span class="p">[</span><span class="n">type_id</span><span class="p">]</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">sub_class</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="n">result_dynamic</span><span class="p">[</span><span class="n">type_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_class</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Can&#39;t load subclasses for entry point </span><span class="si">{</span><span class="n">entry_point_name</span><span class="si">}</span><span class="s2"> and base class </span><span class="si">{</span><span class="n">base_class</span><span class="si">}</span><span class="s2">: invalid plugin type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">plugin</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result_dynamic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result_entrypoints</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Duplicate item name &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; for type </span><span class="si">{</span><span class="n">entry_point_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">result_entrypoints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">type_id_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> Most likely the name is picked up from a subclass, try to add a &#39;</span><span class="si">{</span><span class="n">type_id_key</span><span class="si">}</span><span class="s2">&#39; class attribute to your implementing class, with the name you want to give your type as value.&quot;</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">result_entrypoints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">return</span> <span class="n">result_entrypoints</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.cli" class="doc doc-heading">
        <code>cli</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#kiara.utils.cli" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.cli.F" class="doc doc-heading">
<code class="highlight language-python"><span class="n">F</span></code>


<a href="#kiara.utils.cli.F" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.cli.FC" class="doc doc-heading">
<code class="highlight language-python"><span class="n">FC</span></code>


<a href="#kiara.utils.cli.FC" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>


<h4 id="kiara.utils.cli-classes">Classes<a href="#kiara.utils.cli-classes" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.cli.OutputFormat" class="doc doc-heading">
        <code>
OutputFormat            (<span title="enum.Enum">Enum</span>)
        </code>



<a href="#kiara.utils.cli.OutputFormat" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>An enumeration.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OutputFormat</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">cls</span><span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">keys_as_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_member_names_</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">values_as_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">cls</span><span class="p">]</span>

    <span class="n">TERMINAL</span> <span class="o">=</span> <span class="s2">&quot;terminal&quot;</span>
    <span class="n">HTML</span> <span class="o">=</span> <span class="s2">&quot;html&quot;</span>
    <span class="n">JSON</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span>
    <span class="n">JSON_INCL_SCHEMA</span> <span class="o">=</span> <span class="s2">&quot;json-incl-schema&quot;</span>
    <span class="n">JSON_SCHEMA</span> <span class="o">=</span> <span class="s2">&quot;json-schema&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.cli.OutputFormat.HTML" class="doc doc-heading">
<code class="highlight language-python"><span class="n">HTML</span></code>


<a href="#kiara.utils.cli.OutputFormat.HTML" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.cli.OutputFormat.JSON" class="doc doc-heading">
<code class="highlight language-python"><span class="n">JSON</span></code>


<a href="#kiara.utils.cli.OutputFormat.JSON" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.cli.OutputFormat.JSON_INCL_SCHEMA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">JSON_INCL_SCHEMA</span></code>


<a href="#kiara.utils.cli.OutputFormat.JSON_INCL_SCHEMA" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.cli.OutputFormat.JSON_SCHEMA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">JSON_SCHEMA</span></code>


<a href="#kiara.utils.cli.OutputFormat.JSON_SCHEMA" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.cli.OutputFormat.TERMINAL" class="doc doc-heading">
<code class="highlight language-python"><span class="n">TERMINAL</span></code>


<a href="#kiara.utils.cli.OutputFormat.TERMINAL" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>








  </div>

    </div>

  </div>


<h4 id="kiara.utils.cli-functions">Functions<a href="#kiara.utils.cli-functions" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.cli.output_format_option" class="doc doc-heading">
<code class="highlight language-python"><span class="n">output_format_option</span><span class="p">(</span><span class="o">*</span><span class="n">param_decls</span><span class="p">)</span></code>


<a href="#kiara.utils.cli.output_format_option" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Attaches an option to the command.  All positional arguments are
passed as parameter declarations to :class:<code>Option</code>; all keyword
arguments are forwarded unchanged (except <code>cls</code>).
This is equivalent to creating an :class:<code>Option</code> instance manually
and attaching it to the :attr:<code>Command.params</code> list.</p>
<p>:param cls: the option class to instantiate.  This defaults to
            :class:<code>Option</code>.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">output_format_option</span><span class="p">(</span><span class="o">*</span><span class="n">param_decls</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">FC</span><span class="p">],</span> <span class="n">FC</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Attaches an option to the command.  All positional arguments are</span>
<span class="sd">    passed as parameter declarations to :class:`Option`; all keyword</span>
<span class="sd">    arguments are forwarded unchanged (except ``cls``).</span>
<span class="sd">    This is equivalent to creating an :class:`Option` instance manually</span>
<span class="sd">    and attaching it to the :attr:`Command.params` list.</span>

<span class="sd">    :param cls: the option class to instantiate.  This defaults to</span>
<span class="sd">                :class:`Option`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">param_decls</span><span class="p">:</span>
        <span class="n">param_decls</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;--format&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">)</span>

    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;help&quot;</span><span class="p">:</span> <span class="s2">&quot;The output format. Defaults to &#39;terminal&#39;.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">click</span><span class="o">.</span><span class="n">Choice</span><span class="p">(</span><span class="n">OutputFormat</span><span class="o">.</span><span class="n">values_as_list</span><span class="p">()),</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">FC</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FC</span><span class="p">:</span>
        <span class="c1"># Issue 926, copy attrs, so pre-defined options can re-use the same cls=</span>
        <span class="n">option_attrs</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">OptionClass</span> <span class="o">=</span> <span class="n">option_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cls&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">Option</span>
        <span class="n">_param_memo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">OptionClass</span><span class="p">(</span><span class="n">param_decls</span><span class="p">,</span> <span class="o">**</span><span class="n">option_attrs</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.cli.render_json_schema_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">render_json_schema_str</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>


<a href="#kiara.utils.cli.render_json_schema_str" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">render_json_schema_str</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">schema_json</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">schema_json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json_str</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.cli.render_json_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">render_json_str</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>


<a href="#kiara.utils.cli.render_json_str" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">render_json_str</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span> <span class="o">|</span> <span class="n">orjson</span><span class="o">.</span><span class="n">OPT_NON_STR_KEYS</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json_str</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.cli.terminal_print" class="doc doc-heading">
<code class="highlight language-python"><span class="n">terminal_print</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_panel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rich_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">empty_line_before</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></code>


<a href="#kiara.utils.cli.terminal_print" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">terminal_print</span><span class="p">(</span>
    <span class="n">msg</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">in_panel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rich_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">empty_line_before</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">config</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">console</span> <span class="o">=</span> <span class="n">get_console</span><span class="p">()</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="n">extract_renderable</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">render_config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="c1"># if hasattr(msg, &quot;create_renderable&quot;):</span>
    <span class="c1">#     msg = msg.create_renderable(**config)  # type: ignore</span>

    <span class="k">if</span> <span class="n">in_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">title_align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">in_panel</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">empty_line_before</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">rich_config</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="o">**</span><span class="n">rich_config</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.cli.terminal_print_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">terminal_print_model</span><span class="p">(</span><span class="o">*</span><span class="n">models</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">empty_line_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_panel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">render_config</span><span class="p">)</span></code>


<a href="#kiara.utils.cli.terminal_print_model" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">terminal_print_model</span><span class="p">(</span>
    <span class="o">*</span><span class="n">models</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">,</span>
    <span class="nb">format</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">OutputFormat</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">empty_line_before</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">in_panel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">render_config</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">TERMINAL</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="n">OutputFormat</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">empty_line_before</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">TERMINAL</span><span class="p">:</span>
            <span class="n">empty_line_before</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">empty_line_before</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">TERMINAL</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">in_panel</span><span class="o">=</span><span class="n">in_panel</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="o">**</span><span class="n">render_config</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rg</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">models</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">renderable</span> <span class="o">=</span> <span class="n">extract_renderable</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">render_config</span><span class="p">)</span>
                <span class="n">rg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">renderable</span><span class="p">)</span>
                <span class="n">rg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rule</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">))</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">extract_renderable</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">render_config</span><span class="p">)</span>
            <span class="n">rg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="o">*</span><span class="n">rg</span><span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">in_panel</span><span class="o">=</span><span class="n">in_panel</span><span class="p">,</span> <span class="o">**</span><span class="n">render_config</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">JSON</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">json_str</span> <span class="o">=</span> <span class="n">render_json_str</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">json_str</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">syntax</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_strs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
                <span class="n">json_str</span> <span class="o">=</span> <span class="n">render_json_str</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
                <span class="n">json_strs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>

            <span class="n">json_str_full</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">json_strs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">json_str_full</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">syntax</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">JSON_SCHEMA</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span>
                <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">schema_json</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span><span class="p">),</span>
                <span class="s2">&quot;json&quot;</span><span class="p">,</span>
                <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">syntax</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_strs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
                <span class="n">json_strs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">render_json_schema_str</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
            <span class="n">json_str_full</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">json_strs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">json_str_full</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">syntax</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">JSON_INCL_SCHEMA</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
            <span class="n">schema</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
            <span class="nb">all</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">schema</span><span class="p">}</span>
            <span class="n">json_str</span> <span class="o">=</span> <span class="n">orjson_dumps</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span><span class="p">)</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">json_str</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">syntax</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
                <span class="n">schema</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">schema</span><span class="p">})</span>
            <span class="n">json_str</span> <span class="o">=</span> <span class="n">orjson_dumps</span><span class="p">(</span><span class="n">all_data</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span><span class="p">)</span>
            <span class="c1"># print(json_str)</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">json_str</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
            <span class="n">terminal_print</span><span class="p">(</span>
                <span class="n">syntax</span><span class="p">,</span>
                <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span>
                <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="n">OutputFormat</span><span class="o">.</span><span class="n">HTML</span><span class="p">:</span>

        <span class="n">all_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;create_html&quot;</span><span class="p">):</span>
                <span class="n">html</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_html</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
                <span class="n">all_html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">all_html</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">html</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

        <span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">all_html</span><span class="p">,</span> <span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
        <span class="n">terminal_print</span><span class="p">(</span>
            <span class="n">syntax</span><span class="p">,</span> <span class="n">empty_line_before</span><span class="o">=</span><span class="n">empty_line_before</span><span class="p">,</span> <span class="n">rich_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;soft_wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



<h4 id="kiara.utils.cli-modules">Modules<a href="#kiara.utils.cli-modules" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-module">



<h5 id="kiara.utils.cli.rich_click" class="doc doc-heading">
        <code>rich_click</code>



<a href="#kiara.utils.cli.rich_click" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






<h6 id="kiara.utils.cli.rich_click-functions">Functions<a href="#kiara.utils.cli.rich_click-functions" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-function">



<h7 id="kiara.utils.cli.rich_click.rich_format_operation_help" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rich_format_operation_help</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span></code>


<a href="#kiara.utils.cli.rich_click.rich_format_operation_help" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Print nicely formatted help text using rich.</p>
<p>Based on original code from rich-cli, by @willmcgugan.
https://github.com/Textualize/rich-cli/blob/8a2767c7a340715fc6fbf4930ace717b9b2fc5e5/src/rich_cli/<strong>main</strong>.py#L162-L236</p>
<p>Replacement for the click function format_help().
Takes a command or group and builds the help text output.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj</code></td>
        <td><code>click.Command or click.Group</code></td>
        <td><p>Command or group to build help text for</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ctx</code></td>
        <td><code>click.Context</code></td>
        <td><p>Click Context object</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>table</code></td>
        <td></td>
        <td><p>a rich table, including all the inputs of the current operation</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/cli/rich_click.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rich_format_operation_help</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">click</span><span class="o">.</span><span class="n">Command</span><span class="p">,</span> <span class="n">click</span><span class="o">.</span><span class="n">Group</span><span class="p">],</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">click</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">operation</span><span class="p">:</span> <span class="n">KiaraOperation</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Print nicely formatted help text using rich.</span>

<span class="sd">    Based on original code from rich-cli, by @willmcgugan.</span>
<span class="sd">    https://github.com/Textualize/rich-cli/blob/8a2767c7a340715fc6fbf4930ace717b9b2fc5e5/src/rich_cli/__main__.py#L162-L236</span>

<span class="sd">    Replacement for the click function format_help().</span>
<span class="sd">    Takes a command or group and builds the help text output.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj (click.Command or click.Group): Command or group to build help text for</span>
<span class="sd">        ctx (click.Context): Click Context object</span>
<span class="sd">        table: a rich table, including all the inputs of the current operation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">renderables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RenderableType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Header text if we have it</span>
    <span class="k">if</span> <span class="n">HEADER_TEXT</span><span class="p">:</span>
        <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Padding</span><span class="p">(</span><span class="n">_make_rich_rext</span><span class="p">(</span><span class="n">HEADER_TEXT</span><span class="p">,</span> <span class="n">STYLE_HEADER_TEXT</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="c1"># Print usage</span>
    <span class="n">cmd_arg</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;module_or_operation&quot;</span><span class="p">]</span>
    <span class="n">_cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[yellow bold]Usage: [/yellow bold][bold]kiara run [OPTIONS] [i]</span><span class="si">{</span><span class="n">cmd_arg</span><span class="si">}</span><span class="s2">[/i] [INPUTS][/bold]&quot;</span>
    <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Padding</span><span class="p">(</span><span class="n">_cmd</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># renderables.append(obj.get_usage(ctx))</span>
    <span class="c1"># renderables.append(Panel(Padding(highlighter(obj.get_usage(ctx)), 1), style=STYLE_USAGE_COMMAND, box=box.MINIMAL))</span>

    <span class="c1"># Print command / group help if we have some</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">full_doc</span>
    <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">Padding</span><span class="p">(</span>
            <span class="n">Align</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">desc</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">MAX_WIDTH</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># if obj.help:</span>
    <span class="c1">#</span>
    <span class="c1">#     # Print with a max width and some padding</span>
    <span class="c1">#     renderables.append(</span>
    <span class="c1">#         Padding(</span>
    <span class="c1">#             Align(_get_help_text(obj), width=MAX_WIDTH, pad=False),</span>
    <span class="c1">#             (0, 1, 1, 1),</span>
    <span class="c1">#         )</span>
    <span class="c1">#     )</span>

    <span class="c1"># Look through OPTION_GROUPS for this command</span>
    <span class="c1"># stick anything unmatched into a default group at the end</span>
    <span class="n">option_groups</span> <span class="o">=</span> <span class="n">OPTION_GROUPS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">command_path</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">option_groups</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">[]})</span>
    <span class="n">argument_group_options</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>

        <span class="c1"># Skip positional arguments - they don&#39;t have opts or helptext and are covered in usage</span>
        <span class="c1"># See https://click.palletsprojects.com/en/8.0.x/documentation/#documenting-arguments</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="ow">is</span> <span class="n">click</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Argument</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">SHOW_ARGUMENTS</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Skip if option is hidden</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s2">&quot;hidden&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="c1"># Already mentioned in a config option group</span>
        <span class="k">for</span> <span class="n">option_group</span> <span class="ow">in</span> <span class="n">option_groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">opt</span> <span class="ow">in</span> <span class="n">option_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="c1"># No break, no mention - add to the default group</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="ow">is</span> <span class="n">click</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Argument</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">GROUP_ARGUMENTS_OPTIONS</span><span class="p">:</span>
                <span class="n">argument_group_options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">list_of_option_groups</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">option_groups</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
                <span class="n">list_of_option_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># If we&#39;re not grouping arguments and we got some, prepend before default options</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument_group_options</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">extra_option_group</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">ARGUMENTS_PANEL_TITLE</span><span class="p">,</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="n">argument_group_options</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">option_groups</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">option_groups</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">extra_option_group</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># Print each option group panel</span>
    <span class="k">for</span> <span class="n">option_group</span> <span class="ow">in</span> <span class="n">option_groups</span><span class="p">:</span>

        <span class="n">options_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">option_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="p">[]):</span>

            <span class="c1"># Get the param</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">opt</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">]):</span>
                    <span class="k">break</span>
            <span class="c1"># Skip if option is not listed in this group</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Short and long form</span>
            <span class="n">opt_long_strs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">opt_short_strs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">opt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">):</span>
                <span class="n">opt_str</span> <span class="o">=</span> <span class="n">opt</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">opt_str</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">param</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">if</span> <span class="s2">&quot;--&quot;</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span>
                    <span class="n">opt_long_strs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_str</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">opt_short_strs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_str</span><span class="p">)</span>

            <span class="c1"># Column for a metavar, if we have one</span>
            <span class="n">metavar</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">STYLE_METAVAR</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s2">&quot;fold&quot;</span><span class="p">)</span>
            <span class="n">metavar_str</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">make_metavar</span><span class="p">()</span>

            <span class="c1"># Do it ourselves if this is a positional argument</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="ow">is</span> <span class="n">click</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Argument</span> <span class="ow">and</span> <span class="n">metavar_str</span> <span class="o">==</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
                <span class="n">metavar_str</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

            <span class="c1"># Skip booleans and choices (handled above)</span>
            <span class="k">if</span> <span class="n">metavar_str</span> <span class="o">!=</span> <span class="s2">&quot;BOOLEAN&quot;</span><span class="p">:</span>
                <span class="n">metavar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metavar_str</span><span class="p">)</span>

            <span class="c1"># Range - from</span>
            <span class="c1"># https://github.com/pallets/click/blob/c63c70dabd3f86ca68678b4f00951f78f52d0270/src/click/core.py#L2698-L2706  # noqa: E501</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># skip count with default range type</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">click</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">_NumberRangeBase</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="n">param</span><span class="o">.</span><span class="n">count</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">min</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
                <span class="p">):</span>
                    <span class="n">range_str</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">_describe_range</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">range_str</span><span class="p">:</span>
                        <span class="n">metavar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RANGE_STRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">range_str</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="c1"># click.types._NumberRangeBase is only in Click 8x onwards</span>
                <span class="k">pass</span>

            <span class="c1"># Required asterisk</span>
            <span class="n">required</span><span class="p">:</span> <span class="n">RenderableType</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
                <span class="n">required</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">REQUIRED_SHORT_STRING</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">STYLE_REQUIRED_SHORT</span><span class="p">)</span>

            <span class="c1"># Highlighter to make [ | ] and &lt;&gt; dim</span>
            <span class="k">class</span> <span class="nc">MetavarHighlighter</span><span class="p">(</span><span class="n">RegexHighlighter</span><span class="p">):</span>
                <span class="n">highlights</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="sa">r</span><span class="s2">&quot;^(?P&lt;metavar_sep&gt;(\[|&lt;))&quot;</span><span class="p">,</span>
                    <span class="sa">r</span><span class="s2">&quot;(?P&lt;metavar_sep&gt;\|)&quot;</span><span class="p">,</span>
                    <span class="sa">r</span><span class="s2">&quot;(?P&lt;metavar_sep&gt;(\]|&gt;)$)&quot;</span><span class="p">,</span>
                <span class="p">]</span>

            <span class="n">metavar_highlighter</span> <span class="o">=</span> <span class="n">MetavarHighlighter</span><span class="p">()</span>

            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">required</span><span class="p">,</span>
                <span class="n">highlighter</span><span class="p">(</span><span class="n">highlighter</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">opt_long_strs</span><span class="p">))),</span>
                <span class="n">highlighter</span><span class="p">(</span><span class="n">highlighter</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">opt_short_strs</span><span class="p">))),</span>
                <span class="n">metavar_highlighter</span><span class="p">(</span><span class="n">metavar</span><span class="p">),</span>
                <span class="n">_get_parameter_help</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
            <span class="p">]</span>

            <span class="c1"># Remove metavar if specified in config</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">SHOW_METAVARS_COLUMN</span><span class="p">:</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

            <span class="n">options_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">options_rows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">t_styles</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;show_lines&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_SHOW_LINES</span><span class="p">,</span>
                <span class="s2">&quot;leading&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_LEADING</span><span class="p">,</span>
                <span class="s2">&quot;box&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_BOX</span><span class="p">,</span>
                <span class="s2">&quot;border_style&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_BORDER_STYLE</span><span class="p">,</span>
                <span class="s2">&quot;row_styles&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_ROW_STYLES</span><span class="p">,</span>
                <span class="s2">&quot;pad_edge&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_PAD_EDGE</span><span class="p">,</span>
                <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="n">STYLE_OPTIONS_TABLE_PADDING</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">t_styles</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">option_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;table_styles&quot;</span><span class="p">,</span> <span class="p">{}))</span>  <span class="c1"># type: ignore</span>
            <span class="n">box_style</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">t_styles</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;box&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="n">options_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
                <span class="n">highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">box</span><span class="o">=</span><span class="n">box_style</span><span class="p">,</span>
                <span class="o">**</span><span class="n">t_styles</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="c1"># Strip the required column if none are required</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">options_rows</span><span class="p">]):</span>
                <span class="n">options_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">options_rows</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">options_rows</span><span class="p">:</span>
                <span class="n">options_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>
            <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Panel</span><span class="p">(</span>
                    <span class="n">options_table</span><span class="p">,</span>
                    <span class="n">border_style</span><span class="o">=</span><span class="n">STYLE_OPTIONS_PANEL_BORDER</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">option_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">OPTIONS_PANEL_TITLE</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                    <span class="n">title_align</span><span class="o">=</span><span class="n">ALIGN_OPTIONS_PANEL</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">MAX_WIDTH</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Groups only:</span>
    <span class="c1"># List click command groups</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;list_commands&quot;</span><span class="p">):</span>
        <span class="c1"># Look through COMMAND_GROUPS for this command</span>
        <span class="c1"># stick anything unmatched into a default group at the end</span>
        <span class="n">cmd_groups</span> <span class="o">=</span> <span class="n">COMMAND_GROUPS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">command_path</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cmd_groups</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;commands&quot;</span><span class="p">:</span> <span class="p">[]})</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
            <span class="k">for</span> <span class="n">cmd_group</span> <span class="ow">in</span> <span class="n">cmd_groups</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">cmd_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;commands&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">commands</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">cmd_groups</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;commands&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
                <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="c1"># Print each command group panel</span>
        <span class="k">for</span> <span class="n">cmd_group</span> <span class="ow">in</span> <span class="n">cmd_groups</span><span class="p">:</span>
            <span class="n">t_styles</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;show_lines&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_SHOW_LINES</span><span class="p">,</span>
                <span class="s2">&quot;leading&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_LEADING</span><span class="p">,</span>
                <span class="s2">&quot;box&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_BOX</span><span class="p">,</span>
                <span class="s2">&quot;border_style&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_BORDER_STYLE</span><span class="p">,</span>
                <span class="s2">&quot;row_styles&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_ROW_STYLES</span><span class="p">,</span>
                <span class="s2">&quot;pad_edge&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_PAD_EDGE</span><span class="p">,</span>
                <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="n">STYLE_COMMANDS_TABLE_PADDING</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">t_styles</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cmd_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;table_styles&quot;</span><span class="p">,</span> <span class="p">{}))</span>  <span class="c1"># type: ignore</span>
            <span class="n">box_style</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">t_styles</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;box&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="n">commands_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
                <span class="n">highlight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">box</span><span class="o">=</span><span class="n">box_style</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="o">**</span><span class="n">t_styles</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="c1"># Define formatting in first column, as commands don&#39;t match highlighter regex</span>
            <span class="n">commands_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold cyan&quot;</span><span class="p">,</span> <span class="n">no_wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">cmd_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;commands&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="c1"># Skip if command does not exist</span>
                <span class="k">if</span> <span class="n">command</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
                    <span class="k">continue</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                <span class="k">assert</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># Use the truncated short text as with vanilla text if requested</span>
                <span class="k">if</span> <span class="n">USE_CLICK_SHORT_HELP</span><span class="p">:</span>
                    <span class="n">helptext</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_short_help_str</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Use short_help function argument if used, or the full help</span>
                    <span class="n">helptext</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">short_help</span> <span class="ow">or</span> <span class="n">cmd</span><span class="o">.</span><span class="n">help</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
                <span class="n">commands_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">_make_command_help</span><span class="p">(</span><span class="n">helptext</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">commands_table</span><span class="o">.</span><span class="n">row_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Panel</span><span class="p">(</span>
                        <span class="n">commands_table</span><span class="p">,</span>
                        <span class="n">border_style</span><span class="o">=</span><span class="n">STYLE_COMMANDS_PANEL_BORDER</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                        <span class="n">title</span><span class="o">=</span><span class="n">cmd_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">COMMANDS_PANEL_TITLE</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                        <span class="n">title_align</span><span class="o">=</span><span class="n">ALIGN_COMMANDS_PANEL</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                        <span class="n">width</span><span class="o">=</span><span class="n">MAX_WIDTH</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                    <span class="p">)</span>
                <span class="p">)</span>

    <span class="n">inputs_table</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">create_renderable</span><span class="p">(</span>
        <span class="n">show_operation_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_operation_doc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">show_outputs_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_headers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">inputs_panel</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span>
        <span class="n">inputs_table</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Inputs&quot;</span><span class="p">,</span>
        <span class="n">border_style</span><span class="o">=</span><span class="n">STYLE_COMMANDS_PANEL_BORDER</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">title_align</span><span class="o">=</span><span class="n">ALIGN_COMMANDS_PANEL</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">width</span><span class="o">=</span><span class="n">MAX_WIDTH</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inputs_panel</span><span class="p">)</span>

    <span class="c1"># Epilogue if we have it</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">epilog</span><span class="p">:</span>
        <span class="c1"># Remove single linebreaks, replace double with single</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">epilog</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">epilogue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">])</span>
        <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Padding</span><span class="p">(</span><span class="n">Align</span><span class="p">(</span><span class="n">highlighter</span><span class="p">(</span><span class="n">epilogue</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">MAX_WIDTH</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Footer text if we have it</span>
    <span class="k">if</span> <span class="n">FOOTER_TEXT</span><span class="p">:</span>
        <span class="n">renderables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Padding</span><span class="p">(</span><span class="n">_make_rich_rext</span><span class="p">(</span><span class="n">FOOTER_TEXT</span><span class="p">,</span> <span class="n">STYLE_FOOTER_TEXT</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="n">group</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="o">*</span><span class="n">renderables</span><span class="p">)</span>
    <span class="n">terminal_print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.concurrency" class="doc doc-heading">
        <code>concurrency</code>



<a href="#kiara.utils.concurrency" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">





<h4 id="kiara.utils.concurrency-classes">Classes<a href="#kiara.utils.concurrency-classes" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.concurrency.ThreadSaveCounter" class="doc doc-heading">
        <code>
ThreadSaveCounter        </code>



<a href="#kiara.utils.concurrency.ThreadSaveCounter" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>A thread-safe counter, can be used in kiara modules to update completion percentage.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/concurrency.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ThreadSaveCounter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A thread-safe counter, can be used in kiara modules to update completion percentage.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current</span>

    <span class="k">def</span> <span class="nf">current_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current</span>

    <span class="k">def</span> <span class="nf">decrement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.concurrency.ThreadSaveCounter.current" class="doc doc-heading">
<code class="highlight language-python"><span class="n">current</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#kiara.utils.concurrency.ThreadSaveCounter.current" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.concurrency.ThreadSaveCounter.current_percent" class="doc doc-heading">
<code class="highlight language-python"><span class="n">current_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span></code>


<a href="#kiara.utils.concurrency.ThreadSaveCounter.current_percent" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/concurrency.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">current_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

    <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.concurrency.ThreadSaveCounter.decrement" class="doc doc-heading">
<code class="highlight language-python"><span class="n">decrement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.concurrency.ThreadSaveCounter.decrement" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/concurrency.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">decrement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.concurrency.ThreadSaveCounter.increment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.concurrency.ThreadSaveCounter.increment" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/concurrency.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.data" class="doc doc-heading">
        <code>data</code>



<a href="#kiara.utils.data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.data.logger" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logger</span></code>


<a href="#kiara.utils.data.logger" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.data.pretty_print_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pretty_print_data</span><span class="p">(</span><span class="n">kiara</span><span class="p">,</span> <span class="n">value_id</span><span class="p">,</span> <span class="n">target_type</span><span class="o">=</span><span class="s1">&#39;terminal_renderable&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">render_config</span><span class="p">)</span></code>


<a href="#kiara.utils.data.pretty_print_data" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pretty_print_data</span><span class="p">(</span>
    <span class="n">kiara</span><span class="p">:</span> <span class="s2">&quot;Kiara&quot;</span><span class="p">,</span>
    <span class="n">value_id</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;terminal_renderable&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">render_config</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">data_registry</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">value_id</span><span class="o">=</span><span class="n">value_id</span><span class="p">)</span>

    <span class="n">op_type</span><span class="p">:</span> <span class="n">PrettyPrintOperationType</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">operation_registry</span><span class="o">.</span><span class="n">get_operation_type</span><span class="p">(</span><span class="s2">&quot;pretty_print&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">op</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Operation</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">op_type</span><span class="o">.</span><span class="n">get_operation_for_render_combination</span><span class="p">(</span>
            <span class="n">source_type</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">target_type</span><span class="o">=</span><span class="n">target_type</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;error.pretty_print&quot;</span><span class="p">,</span>
            <span class="n">source_type</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
            <span class="n">target_type</span><span class="o">=</span><span class="n">target_type</span><span class="p">,</span>
            <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">op</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">target_type</span> <span class="o">==</span> <span class="s2">&quot;terminal_renderable&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">op</span> <span class="o">=</span> <span class="n">op_type</span><span class="o">.</span><span class="n">get_operation_for_render_combination</span><span class="p">(</span>
                    <span class="n">source_type</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">if</span> <span class="n">op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t find operation to render &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&#39; as &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">kiara</span><span class="o">=</span><span class="n">kiara</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
    <span class="n">rendered</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;rendered_value&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rendered</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.data.render_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">render_value</span><span class="p">(</span><span class="n">kiara</span><span class="p">,</span> <span class="n">value_id</span><span class="p">,</span> <span class="n">target_type</span><span class="o">=</span><span class="s1">&#39;terminal_renderable&#39;</span><span class="p">,</span> <span class="n">render_instruction</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.data.render_value" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">render_value</span><span class="p">(</span>
    <span class="n">kiara</span><span class="p">:</span> <span class="s2">&quot;Kiara&quot;</span><span class="p">,</span>
    <span class="n">value_id</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;terminal_renderable&quot;</span><span class="p">,</span>
    <span class="n">render_instruction</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RenderInstruction</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RenderValueResult</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">data_registry</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">value_id</span><span class="o">=</span><span class="n">value_id</span><span class="p">)</span>
    <span class="n">op_type</span><span class="p">:</span> <span class="n">RenderValueOperationType</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">operation_registry</span><span class="o">.</span><span class="n">get_operation_type</span><span class="p">(</span><span class="s2">&quot;render_value&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="n">ops</span> <span class="o">=</span> <span class="n">op_type</span><span class="o">.</span><span class="n">get_render_operations_for_source_type</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">data_type_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">target_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ops</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ops</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No render operations registered for source type &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">data_type_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Registered target types for source type &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ops</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No render operation for source type &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">data_type_name</span><span class="si">}</span><span class="s2">&#39; to target type &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">&#39; registered. </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="n">target_type</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">kiara</span><span class="o">=</span><span class="n">kiara</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s2">&quot;render_instruction&quot;</span><span class="p">:</span> <span class="n">render_instruction</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">RenderValueResult</span><span class="p">(</span>
        <span class="n">rendered</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;rendered_value&quot;</span><span class="p">),</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;render_metadata&quot;</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.db" class="doc doc-heading">
        <code>db</code>



<a href="#kiara.utils.db" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.db.get_kiara_db_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_kiara_db_url</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span></code>


<a href="#kiara.utils.db.get_kiara_db_url" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_kiara_db_url</span><span class="p">(</span><span class="n">base_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

    <span class="n">abs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">base_path</span><span class="p">))</span>
    <span class="n">db_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">abs_path</span><span class="si">}</span><span class="s2">/kiara.db&quot;</span>
    <span class="k">return</span> <span class="n">db_url</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.db.orm_json_deserialize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">orm_json_deserialize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>


<a href="#kiara.utils.db.orm_json_deserialize" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">orm_json_deserialize</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">orjson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.db.orm_json_serialize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">orm_json_serialize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>


<a href="#kiara.utils.db.orm_json_serialize" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/db.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">orm_json_serialize</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">orjson_dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported type for json serialization: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.debug" class="doc doc-heading">
        <code>debug</code>



<a href="#kiara.utils.debug" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.debug.DEFAULT_VALUE_MAP_RENDER_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_VALUE_MAP_RENDER_CONFIG</span></code>


<a href="#kiara.utils.debug.DEFAULT_VALUE_MAP_RENDER_CONFIG" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.debug.create_module_preparation_table" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_module_preparation_table</span><span class="p">(</span><span class="n">manifest</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">render_config</span><span class="p">)</span></code>


<a href="#kiara.utils.debug.create_module_preparation_table" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/debug.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_module_preparation_table</span><span class="p">(</span>
    <span class="n">manifest</span><span class="p">:</span> <span class="n">Manifest</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">**</span><span class="n">render_config</span>
<span class="p">):</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;module&quot;</span><span class="p">,</span> <span class="n">manifest</span><span class="o">.</span><span class="n">module_type</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">manifest</span><span class="o">.</span><span class="n">module_config</span><span class="p">:</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span>
            <span class="n">orjson_dumps</span><span class="p">(</span><span class="n">manifest</span><span class="o">.</span><span class="n">module_config</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span><span class="p">),</span>
            <span class="s2">&quot;json&quot;</span><span class="p">,</span>
            <span class="n">background_color</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;module config&quot;</span><span class="p">,</span> <span class="n">mc</span><span class="p">)</span>
    <span class="n">value_map_rend</span> <span class="o">=</span> <span class="n">create_value_map_renderable</span><span class="p">(</span><span class="n">value_map</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">render_config</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="n">value_map_rend</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.debug.create_value_map_renderable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_value_map_renderable</span><span class="p">(</span><span class="n">value_map</span><span class="p">,</span> <span class="o">**</span><span class="n">render_config</span><span class="p">)</span></code>


<a href="#kiara.utils.debug.create_value_map_renderable" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/debug.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_value_map_renderable</span><span class="p">(</span><span class="n">value_map</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">**</span><span class="n">render_config</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>

    <span class="n">rc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">DEFAULT_VALUE_MAP_RENDER_CONFIG</span><span class="p">)</span>
    <span class="n">rc</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">render_config</span><span class="p">)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">show_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;field name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">row</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Value</span><span class="p">):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;value object&quot;</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">create_renderable</span><span class="p">(</span><span class="o">**</span><span class="n">rc</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;value id&quot;</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;raw data&quot;</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.debug.terminal_print_manifest" class="doc doc-heading">
<code class="highlight language-python"><span class="n">terminal_print_manifest</span><span class="p">(</span><span class="n">manifest</span><span class="p">)</span></code>


<a href="#kiara.utils.debug.terminal_print_manifest" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/debug.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">terminal_print_manifest</span><span class="p">(</span><span class="n">manifest</span><span class="p">:</span> <span class="n">Manifest</span><span class="p">):</span>

    <span class="n">terminal_print</span><span class="p">(</span><span class="n">manifest</span><span class="o">.</span><span class="n">create_renderable</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.doc" class="doc doc-heading">
        <code>doc</code>



<a href="#kiara.utils.doc" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.doc.extract_doc_from_cls" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_doc_from_cls</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">only_first_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.doc.extract_doc_from_cls" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/doc.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_doc_from_cls</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="n">only_first_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

    <span class="n">doc</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__doc__</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">DEFAULT_NO_DESC_VALUE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">cleandoc</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">only_first_line</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">first_line</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.global_metadata" class="doc doc-heading">
        <code>global_metadata</code>



<a href="#kiara.utils.global_metadata" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.global_metadata.get_metadata_for_python_module_or_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_metadata_for_python_module_or_class</span><span class="p">(</span><span class="n">module_or_class</span><span class="p">)</span></code>


<a href="#kiara.utils.global_metadata.get_metadata_for_python_module_or_class" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/global_metadata.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">get_metadata_for_python_module_or_class</span><span class="p">(</span>
    <span class="n">module_or_class</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>

    <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_or_class</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module_or_class</span><span class="p">,</span> <span class="n">KIARA_MODULE_METADATA_ATTRIBUTE</span><span class="p">):</span>
            <span class="n">md</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module_or_class</span><span class="p">,</span> <span class="n">KIARA_MODULE_METADATA_ATTRIBUTE</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span><span class="p">)</span>
            <span class="n">metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">_module_or_class</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">module_or_class</span><span class="o">.</span><span class="vm">__module__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_module_or_class</span> <span class="o">=</span> <span class="n">module_or_class</span>

    <span class="n">current_module</span> <span class="o">=</span> <span class="n">_module_or_class</span>
    <span class="k">while</span> <span class="n">current_module</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">current_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">current_module</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">current_module</span><span class="p">,</span> <span class="n">KIARA_MODULE_METADATA_ATTRIBUTE</span><span class="p">):</span>
            <span class="n">md</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">current_module</span><span class="p">,</span> <span class="n">KIARA_MODULE_METADATA_ATTRIBUTE</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span><span class="p">)</span>
            <span class="n">metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">current_module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="n">current_module</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_module</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_module</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">metadata</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">metadata</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.graphs" class="doc doc-heading">
        <code>graphs</code>



<a href="#kiara.utils.graphs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.graphs.print_ascii_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">print_ascii_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code>


<a href="#kiara.utils.graphs.print_ascii_graph" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/graphs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">print_ascii_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">asciinet</span> <span class="kn">import</span> <span class="n">graph_to_ascii</span>
    <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Can&#39;t print graph on terminal, package &#39;asciinet&#39; not available. Please install it into the current virtualenv using:</span><span class="se">\n\n</span><span class="s2">pip install &#39;git+https://github.com/cosminbasca/asciinet.git#egg=asciinet&amp;subdirectory=pyasciinet&#39;&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">asciinet._libutil</span> <span class="kn">import</span> <span class="n">check_java</span>

        <span class="n">check_java</span><span class="p">(</span><span class="s2">&quot;Java &quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Java is currently necessary to print ascii graph. This might change in the future, but to use this functionality please install a JRE.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">graph_to_ascii</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.hashfs" class="doc doc-heading">
        <code>hashfs</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#kiara.utils.hashfs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>HashFS is a content-addressable file management system. What does that mean?
Simply, that HashFS manages a directory where files are saved based on the
file's hash.</p>
<p>Typical use cases for this kind of system are ones where:</p>
<ul>
<li>Files are written once and never change (e.g. image storage).</li>
<li>It's desirable to have no duplicate files (e.g. user uploads).</li>
<li>File metadata is stored elsewhere (e.g. in a database).</li>
</ul>
<p>Adapted from: https://github.com/dgilland/hashfs</p>
<h4 id="kiara.utils.hashfs--license">License<a class="headerlink" href="#kiara.utils.hashfs--license" title="Permanent link">&para;</a></h4>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2015, Derrick Gilland</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>



  <div class="doc doc-children">





<h4 id="kiara.utils.hashfs-classes">Classes<a href="#kiara.utils.hashfs-classes" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.hashfs.HashAddress" class="doc doc-heading">
        <code>
HashAddress            (<a class="autorefs autorefs-internal" title="kiara.utils.hashfs.HashAddress" href="../hashfs/__init__/#kiara.utils.hashfs.HashAddress">HashAddress</a>)
        </code>



<a href="#kiara.utils.hashfs.HashAddress" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>File address containing file's path on disk and it's content hash ID.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>id</code></td>
        <td><code>str</code></td>
        <td><p>Hash ID (hexdigest) of file contents.</p></td>
      </tr>
      <tr>
        <td><code>relpath</code></td>
        <td><code>str</code></td>
        <td><p>Relative path location to :attr:<code>HashFS.root</code>.</p></td>
      </tr>
      <tr>
        <td><code>abspath</code></td>
        <td><code>str</code></td>
        <td><p>Absoluate path location of file on disk.</p></td>
      </tr>
      <tr>
        <td><code>is_duplicate</code></td>
        <td><code>boolean</code></td>
        <td><p>Whether the hash address created was
a duplicate of a previously existing file. Can only be <code>True</code>
after a put operation. Defaults to <code>False</code>.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">HashAddress</span><span class="p">(</span>
    <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;HashAddress&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;relpath&quot;</span><span class="p">,</span> <span class="s2">&quot;abspath&quot;</span><span class="p">,</span> <span class="s2">&quot;is_duplicate&quot;</span><span class="p">])</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;File address containing file&#39;s path on disk and it&#39;s content hash ID.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        id (str): Hash ID (hexdigest) of file contents.</span>
<span class="sd">        relpath (str): Relative path location to :attr:`HashFS.root`.</span>
<span class="sd">        abspath (str): Absoluate path location of file on disk.</span>
<span class="sd">        is_duplicate (boolean, optional): Whether the hash address created was</span>
<span class="sd">            a duplicate of a previously existing file. Can only be ``True``</span>
<span class="sd">            after a put operation. Defaults to ``False``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">relpath</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">HashAddress</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">relpath</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div>
        </details>


    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.hashfs.HashFS" class="doc doc-heading">
        <code>
HashFS        </code>



<a href="#kiara.utils.hashfs.HashFS" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Content addressable file manager.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>root</code></td>
        <td><code>str</code></td>
        <td><p>Directory path used as root of storage space.</p></td>
      </tr>
      <tr>
        <td><code>depth</code></td>
        <td><code>int</code></td>
        <td><p>Depth of subfolders to create when saving a
file.</p></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>Width of each subfolder to create when saving a
file.</p></td>
      </tr>
      <tr>
        <td><code>algorithm</code></td>
        <td><code>str</code></td>
        <td><p>Hash algorithm to use when computing file hash.
Algorithm should be available in <code>hashlib</code> module. Defaults to
<code>'sha256'</code>.</p></td>
      </tr>
      <tr>
        <td><code>fmode</code></td>
        <td><code>int</code></td>
        <td><p>File mode permission to set when adding files to
directory. Defaults to <code>0o664</code> which allows owner/group to
read/write and everyone else to read.</p></td>
      </tr>
      <tr>
        <td><code>dmode</code></td>
        <td><code>int</code></td>
        <td><p>Directory mode permission to set for
subdirectories. Defaults to <code>0o755</code> which allows owner/group to
read/write and everyone else to read and everyone to execute.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">HashFS</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Content addressable file manager.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        root (str): Directory path used as root of storage space.</span>
<span class="sd">        depth (int, optional): Depth of subfolders to create when saving a</span>
<span class="sd">            file.</span>
<span class="sd">        width (int, optional): Width of each subfolder to create when saving a</span>
<span class="sd">            file.</span>
<span class="sd">        algorithm (str): Hash algorithm to use when computing file hash.</span>
<span class="sd">            Algorithm should be available in ``hashlib`` module. Defaults to</span>
<span class="sd">            ``&#39;sha256&#39;``.</span>
<span class="sd">        fmode (int, optional): File mode permission to set when adding files to</span>
<span class="sd">            directory. Defaults to ``0o664`` which allows owner/group to</span>
<span class="sd">            read/write and everyone else to read.</span>
<span class="sd">        dmode (int, optional): Directory mode permission to set for</span>
<span class="sd">            subdirectories. Defaults to ``0o755`` which allows owner/group to</span>
<span class="sd">            read/write and everyone else to read and everyone to execute.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sha256&quot;</span><span class="p">,</span>
        <span class="n">fmode</span><span class="o">=</span><span class="mo">0o664</span><span class="p">,</span>
        <span class="n">dmode</span><span class="o">=</span><span class="mo">0o755</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">algorithm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmode</span> <span class="o">=</span> <span class="n">fmode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dmode</span> <span class="o">=</span> <span class="n">dmode</span>

    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HashAddress&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Store contents of `file` on disk using its content hash for the</span>
<span class="sd">        address.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (mixed): Readable object or path to file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HashAddress: File&#39;s hash address.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computehash</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
            <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">HashAddress</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">put_with_precomputed_hash</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">BinaryIO</span><span class="p">],</span> <span class="n">hash_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HashAddress&quot;</span><span class="p">:</span>

        <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
            <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">hash_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">HashAddress</span><span class="p">(</span><span class="n">hash_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="s2">&quot;Stream&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the contents of `stream` onto disk with an optional file</span>
<span class="sd">        extension appended. The copy process uses a temporary file to store the</span>
<span class="sd">        initial contents and then moves that file to it&#39;s final location.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">idpath</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="c1"># Only move file if it doesn&#39;t already exist.</span>
            <span class="n">is_duplicate</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mktempfile</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">makepath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_duplicate</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mktempfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a named temporary file from a :class:`Stream` object and</span>
<span class="sd">        return its filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">oldmask</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmode</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="n">oldmask</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

        <span class="n">tmp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return :class:`HashAdress` from given id or path. If `file` does not</span>
<span class="sd">        refer to a valid file, then ``None`` is returned.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (str): Address ID or path of file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HashAddress: File&#39;s hash address.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">realpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HashAddress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unshard</span><span class="p">(</span><span class="n">realpath</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">realpath</span><span class="p">),</span> <span class="n">realpath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;rb&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return open buffer object from given id or path.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (str): Address ID or path of file.</span>
<span class="sd">            mode (str, optional): Mode to open file in. Defaults to ``&#39;rb&#39;``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Buffer: An ``io`` buffer dependent on the `mode`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If file doesn&#39;t exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">realpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not locate file: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">realpath</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete file using id or path. Remove any empty directories after</span>
<span class="sd">        deleting. No exception is raised if file doesn&#39;t exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (str): Address ID or path of file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">realpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">realpath</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_empty</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">realpath</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Successively remove all empty folders starting with `subpath` and</span>
<span class="sd">        proceeding &quot;up&quot; through directory tree until reaching the :attr:`root`</span>
<span class="sd">        folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Don&#39;t attempt to remove any folders if subpath is not a</span>
        <span class="c1"># subdirectory of the root directory.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">haspath</span><span class="p">(</span><span class="n">subpath</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">while</span> <span class="n">subpath</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">subpath</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="n">subpath</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">subpath</span><span class="p">)</span>
            <span class="n">subpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">subpath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return generator that yields all files in the :attr:`root`</span>
<span class="sd">        directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return generator that yields all folders in the :attr:`root`</span>
<span class="sd">        directory that contain files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">files</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">folder</span>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return count of the number of files in the :attr:`root` directory.&quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">count</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the total size in bytes of all files in the :attr:`root`</span>
<span class="sd">        directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">():</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">total</span>

    <span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check whether a given file id or path exists on disk.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">haspath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether `path` is a subdirectory of the :attr:`root`</span>
<span class="sd">        directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">issubdir</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">makepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Physically create the folder path on disk.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dmode</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="s2">&quot;expected </span><span class="si">{}</span><span class="s2"> to be a directory&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">relpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return `path` relative to the :attr:`root` directory.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">realpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attempt to determine the real path of a file id or path through</span>
<span class="sd">        successive checking of candidate paths. If the real path is stored with</span>
<span class="sd">        an extension, the path is considered a match if the basename matches</span>
<span class="sd">        the expected file path of the id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for absoluate path.</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">file</span>

        <span class="c1"># Check for relative path.</span>
        <span class="n">relpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">relpath</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">relpath</span>

        <span class="c1"># Check for sharded path.</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">idpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">filepath</span>

        <span class="c1"># Check for sharded path with any extension.</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">.*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">paths</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Could not determine a match.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">idpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build the file path for a given hash id. Optionally, append a</span>
<span class="sd">        file extension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shard</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="o">*</span><span class="n">paths</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">computehash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Compute hash of file using :attr:`algorithm`.&quot;&quot;&quot;</span>
        <span class="n">hashobj</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">hashobj</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">hashobj</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">shard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shard content ID into subfolders.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">shard</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unshard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unshard path to determine hash value.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">haspath</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot unshard path. The path </span><span class="si">{0!r}</span><span class="s2"> is not &quot;</span>
                <span class="s2">&quot;a subdirectory of the root directory </span><span class="si">{1!r}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">repair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Repair any file locations whose content address doesn&#39;t match it&#39;s</span>
<span class="sd">        file path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repaired</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">corrupted</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corrupted</span><span class="p">())</span>
        <span class="n">oldmask</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">corrupted</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">):</span>
                    <span class="c1"># File already exists so just delete corrupted path.</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># File doesn&#39;t exists so move it.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">makepath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">))</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">)</span>

                <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmode</span><span class="p">)</span>
                <span class="n">repaired</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">address</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="n">oldmask</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">repaired</span>

    <span class="k">def</span> <span class="nf">corrupted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return generator that yields corrupted files as ``(path, address)``</span>
<span class="sd">        where ``path`` is the path of the corrupted file and ``address`` is</span>
<span class="sd">        the :class:`HashAddress` of the expected location.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">():</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computehash</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>

            <span class="n">expected_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">idpath</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">expected_path</span> <span class="o">!=</span> <span class="n">path</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span>
                    <span class="n">path</span><span class="p">,</span>
                    <span class="n">HashAddress</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">expected_path</span><span class="p">),</span> <span class="n">expected_path</span><span class="p">),</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether a given file id or path is contained in the</span>
<span class="sd">        :attr:`root` directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterate over all files in the :attr:`root` directory.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return count of the number of files in the :attr:`root` directory.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h6 id="kiara.utils.hashfs.HashFS-methods">Methods<a href="#kiara.utils.hashfs.HashFS-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.computehash" class="doc doc-heading">
<code class="highlight language-python"><span class="n">computehash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.computehash" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Compute hash of file using :attr:<code>algorithm</code>.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">computehash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute hash of file using :attr:`algorithm`.&quot;&quot;&quot;</span>
    <span class="n">hashobj</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
        <span class="n">hashobj</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hashobj</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.corrupted" class="doc doc-heading">
<code class="highlight language-python"><span class="n">corrupted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.corrupted" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return generator that yields corrupted files as <code>(path, address)</code>
where <code>path</code> is the path of the corrupted file and <code>address</code> is
the :class:<code>HashAddress</code> of the expected location.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">corrupted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return generator that yields corrupted files as ``(path, address)``</span>
<span class="sd">    where ``path`` is the path of the corrupted file and ``address`` is</span>
<span class="sd">    the :class:`HashAddress` of the expected location.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">():</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computehash</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>

        <span class="n">expected_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">idpath</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expected_path</span> <span class="o">!=</span> <span class="n">path</span><span class="p">:</span>
            <span class="k">yield</span> <span class="p">(</span>
                <span class="n">path</span><span class="p">,</span>
                <span class="n">HashAddress</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">expected_path</span><span class="p">),</span> <span class="n">expected_path</span><span class="p">),</span>
            <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.count" class="doc doc-heading">
<code class="highlight language-python"><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.count" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return count of the number of files in the :attr:<code>root</code> directory.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return count of the number of files in the :attr:`root` directory.&quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.delete" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.delete" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Delete file using id or path. Remove any empty directories after
deleting. No exception is raised if file doesn't exist.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>file</code></td>
        <td><code>str</code></td>
        <td><p>Address ID or path of file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete file using id or path. Remove any empty directories after</span>
<span class="sd">    deleting. No exception is raised if file doesn&#39;t exist.</span>

<span class="sd">    Args:</span>
<span class="sd">        file (str): Address ID or path of file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">realpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">realpath</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_empty</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">realpath</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.exists" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.exists" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Check whether a given file id or path exists on disk.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check whether a given file id or path exists on disk.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.files" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return generator that yields all files in the :attr:<code>root</code>
directory.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return generator that yields all files in the :attr:`root`</span>
<span class="sd">    directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.folders" class="doc doc-heading">
<code class="highlight language-python"><span class="n">folders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.folders" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return generator that yields all folders in the :attr:<code>root</code>
directory that contain files.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return generator that yields all folders in the :attr:`root`</span>
<span class="sd">    directory that contain files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">folder</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.get" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return :class:<code>HashAdress</code> from given id or path. If <code>file</code> does not
refer to a valid file, then <code>None</code> is returned.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>file</code></td>
        <td><code>str</code></td>
        <td><p>Address ID or path of file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>HashAddress</code></td>
      <td><p>File's hash address.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return :class:`HashAdress` from given id or path. If `file` does not</span>
<span class="sd">    refer to a valid file, then ``None`` is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        file (str): Address ID or path of file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HashAddress: File&#39;s hash address.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">realpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HashAddress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unshard</span><span class="p">(</span><span class="n">realpath</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">realpath</span><span class="p">),</span> <span class="n">realpath</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.haspath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">haspath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.haspath" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return whether <code>path</code> is a subdirectory of the :attr:<code>root</code>
directory.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">haspath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return whether `path` is a subdirectory of the :attr:`root`</span>
<span class="sd">    directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">issubdir</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.idpath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">idpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.idpath" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Build the file path for a given hash id. Optionally, append a
file extension.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">idpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build the file path for a given hash id. Optionally, append a</span>
<span class="sd">    file extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shard</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="o">*</span><span class="n">paths</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.makepath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">makepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.makepath" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Physically create the folder path on disk.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">makepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Physically create the folder path on disk.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dmode</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="s2">&quot;expected </span><span class="si">{}</span><span class="s2"> to be a directory&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.open" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.open" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return open buffer object from given id or path.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>file</code></td>
        <td><code>str</code></td>
        <td><p>Address ID or path of file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>Mode to open file in. Defaults to <code>'rb'</code>.</p></td>
        <td><code>&#39;rb&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Buffer</code></td>
      <td><p>An <code>io</code> buffer dependent on the <code>mode</code>.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>IOError</code></td>
        <td><p>If file doesn't exist.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;rb&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return open buffer object from given id or path.</span>

<span class="sd">    Args:</span>
<span class="sd">        file (str): Address ID or path of file.</span>
<span class="sd">        mode (str, optional): Mode to open file in. Defaults to ``&#39;rb&#39;``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Buffer: An ``io`` buffer dependent on the `mode`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        IOError: If file doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">realpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not locate file: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">realpath</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.put" class="doc doc-heading">
<code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.put" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Store contents of <code>file</code> on disk using its content hash for the
address.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>file</code></td>
        <td><code>mixed</code></td>
        <td><p>Readable object or path to file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>HashAddress</code></td>
      <td><p>File's hash address.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HashAddress&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Store contents of `file` on disk using its content hash for the</span>
<span class="sd">    address.</span>

<span class="sd">    Args:</span>
<span class="sd">        file (mixed): Readable object or path to file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HashAddress: File&#39;s hash address.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computehash</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
        <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">HashAddress</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.put_with_precomputed_hash" class="doc doc-heading">
<code class="highlight language-python"><span class="n">put_with_precomputed_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">hash_id</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.put_with_precomputed_hash" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">put_with_precomputed_hash</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">BinaryIO</span><span class="p">],</span> <span class="n">hash_id</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HashAddress&quot;</span><span class="p">:</span>

    <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
        <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">hash_id</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">HashAddress</span><span class="p">(</span><span class="n">hash_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.realpath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">realpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.realpath" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Attempt to determine the real path of a file id or path through
successive checking of candidate paths. If the real path is stored with
an extension, the path is considered a match if the basename matches
the expected file path of the id.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">realpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attempt to determine the real path of a file id or path through</span>
<span class="sd">    successive checking of candidate paths. If the real path is stored with</span>
<span class="sd">    an extension, the path is considered a match if the basename matches</span>
<span class="sd">    the expected file path of the id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for absoluate path.</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">file</span>

    <span class="c1"># Check for relative path.</span>
    <span class="n">relpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">relpath</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">relpath</span>

    <span class="c1"># Check for sharded path.</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">idpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">filepath</span>

    <span class="c1"># Check for sharded path with any extension.</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">.*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">paths</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Could not determine a match.</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.relpath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">relpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.relpath" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return <code>path</code> relative to the :attr:<code>root</code> directory.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">relpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return `path` relative to the :attr:`root` directory.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.remove_empty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subpath</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.remove_empty" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Successively remove all empty folders starting with <code>subpath</code> and
proceeding "up" through directory tree until reaching the :attr:<code>root</code>
folder.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subpath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Successively remove all empty folders starting with `subpath` and</span>
<span class="sd">    proceeding &quot;up&quot; through directory tree until reaching the :attr:`root`</span>
<span class="sd">    folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Don&#39;t attempt to remove any folders if subpath is not a</span>
    <span class="c1"># subdirectory of the root directory.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">haspath</span><span class="p">(</span><span class="n">subpath</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">while</span> <span class="n">subpath</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">subpath</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="n">subpath</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">subpath</span><span class="p">)</span>
        <span class="n">subpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">subpath</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.repair" class="doc doc-heading">
<code class="highlight language-python"><span class="n">repair</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.repair" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Repair any file locations whose content address doesn't match it's
file path.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">repair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Repair any file locations whose content address doesn&#39;t match it&#39;s</span>
<span class="sd">    file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repaired</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corrupted</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corrupted</span><span class="p">())</span>
    <span class="n">oldmask</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">corrupted</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">):</span>
                <span class="c1"># File already exists so just delete corrupted path.</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># File doesn&#39;t exists so move it.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">makepath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">))</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">)</span>

            <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">abspath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmode</span><span class="p">)</span>
            <span class="n">repaired</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">address</span><span class="p">))</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="n">oldmask</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">repaired</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.shard" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.shard" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Shard content ID into subfolders.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">shard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shard content ID into subfolders.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">shard</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.size" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Return the total size in bytes of all files in the :attr:<code>root</code>
directory.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the total size in bytes of all files in the :attr:`root`</span>
<span class="sd">    directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">():</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">total</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.HashFS.unshard" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unshard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.HashFS.unshard" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Unshard path to determine hash value.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">unshard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unshard path to determine hash value.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">haspath</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot unshard path. The path </span><span class="si">{0!r}</span><span class="s2"> is not &quot;</span>
            <span class="s2">&quot;a subdirectory of the root directory </span><span class="si">{1!r}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.hashfs.Stream" class="doc doc-heading">
        <code>
Stream        </code>



<a href="#kiara.utils.hashfs.Stream" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Common interface for file-like objects.</p>
<p>The input <code>obj</code> can be a file-like object or a path to a file. If <code>obj</code> is
a path to a file, then it will be opened until :meth:<code>close</code> is called.
If <code>obj</code> is a file-like object, then it's original position will be
restored when :meth:<code>close</code> is called instead of closing the object
automatically. Closing of the stream is deferred to whatever process passed
the stream in.</p>
<p>Successive readings of the stream is supported without having to manually
set it's position back to <code>0</code>.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Stream</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Common interface for file-like objects.</span>

<span class="sd">    The input `obj` can be a file-like object or a path to a file. If `obj` is</span>
<span class="sd">    a path to a file, then it will be opened until :meth:`close` is called.</span>
<span class="sd">    If `obj` is a file-like object, then it&#39;s original position will be</span>
<span class="sd">    restored when :meth:`close` is called instead of closing the object</span>
<span class="sd">    automatically. Closing of the stream is deferred to whatever process passed</span>
<span class="sd">    the stream in.</span>

<span class="sd">    Successive readings of the stream is supported without having to manually</span>
<span class="sd">    set it&#39;s position back to ``0``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Object must be a valid file path or a readable object&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">file_stat</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="n">buffer_size</span> <span class="o">=</span> <span class="n">file_stat</span><span class="o">.</span><span class="n">st_blksize</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">8192</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read underlying IO object and yield results. Return object to</span>
<span class="sd">        original position if we didn&#39;t open it originally.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="k">yield</span> <span class="n">data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close underlying IO object if we opened it, else return it to</span>
<span class="sd">        original position.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h6 id="kiara.utils.hashfs.Stream-methods">Methods<a href="#kiara.utils.hashfs.Stream-methods" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.hashfs.Stream.close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.Stream.close" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Close underlying IO object if we opened it, else return it to
original position.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Close underlying IO object if we opened it, else return it to</span>
<span class="sd">    original position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>


<h4 id="kiara.utils.hashfs-functions">Functions<a href="#kiara.utils.hashfs-functions" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashfs.compact" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compact</span><span class="p">(</span><span class="n">items</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.compact" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return only truthy elements of <code>items</code>.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compact</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return only truthy elements of `items`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="n">item</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashfs.issubdir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">issubdir</span><span class="p">(</span><span class="n">subpath</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.issubdir" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return whether <code>subpath</code> is a sub-directory of <code>path</code>.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">issubdir</span><span class="p">(</span><span class="n">subpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return whether `subpath` is a sub-directory of `path`.&quot;&quot;&quot;</span>
    <span class="c1"># Append os.sep so that paths like /usr/var2/log doesn&#39;t match /usr/var.</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
    <span class="n">subpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">subpath</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">subpath</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashfs.shard" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shard</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.shard" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">shard</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
    <span class="c1"># This creates a list of `depth` number of tokens with width</span>
    <span class="c1"># `width` from the first part of the id plus the remainder.</span>
    <span class="k">return</span> <span class="n">compact</span><span class="p">(</span>
        <span class="p">[</span><span class="n">digest</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">width</span> <span class="p">:</span> <span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">depth</span><span class="p">)]</span>  <span class="c1"># noqa</span>
        <span class="o">+</span> <span class="p">[</span><span class="n">digest</span><span class="p">[</span><span class="n">depth</span> <span class="o">*</span> <span class="n">width</span> <span class="p">:]]</span>  <span class="c1"># noqa</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashfs.to_bytes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_bytes</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>


<a href="#kiara.utils.hashfs.to_bytes" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashfs/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.hashing" class="doc doc-heading">
        <code>hashing</code>



<a href="#kiara.utils.hashing" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.hashing.NONE_CID" class="doc doc-heading">
<code class="highlight language-python"><span class="n">NONE_CID</span></code>


<a href="#kiara.utils.hashing.NONE_CID" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashing.compute_cid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_cid</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hash_codec</span><span class="o">=</span><span class="s1">&#39;sha2-256&#39;</span><span class="p">,</span> <span class="n">encode</span><span class="o">=</span><span class="s1">&#39;base58btc&#39;</span><span class="p">)</span></code>


<a href="#kiara.utils.hashing.compute_cid" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_cid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">EncodableType</span><span class="p">,</span>
    <span class="n">hash_codec</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sha2-256&quot;</span><span class="p">,</span>
    <span class="n">encode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;base58btc&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">CID</span><span class="p">]:</span>

    <span class="n">encoded</span> <span class="o">=</span> <span class="n">dag_cbor</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">hash_func</span> <span class="o">=</span> <span class="n">multihash</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hash_codec</span><span class="p">)</span>
    <span class="n">digest</span> <span class="o">=</span> <span class="n">hash_func</span><span class="o">.</span><span class="n">digest</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>

    <span class="n">cid</span> <span class="o">=</span> <span class="n">CID</span><span class="p">(</span><span class="n">encode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="s2">&quot;dag-cbor&quot;</span><span class="p">,</span> <span class="n">digest</span><span class="o">=</span><span class="n">digest</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encoded</span><span class="p">,</span> <span class="n">cid</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashing.compute_cid_from_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_cid_from_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">hash_codec</span><span class="o">=</span><span class="s1">&#39;sha2-256&#39;</span><span class="p">)</span></code>


<a href="#kiara.utils.hashing.compute_cid_from_file" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_cid_from_file</span><span class="p">(</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">codec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Multicodec</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;raw&quot;</span><span class="p">,</span> <span class="n">hash_codec</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sha2-256&quot;</span>
<span class="p">):</span>

    <span class="k">assert</span> <span class="n">hash_codec</span> <span class="o">==</span> <span class="s2">&quot;sha2-256&quot;</span>

    <span class="n">hash_func</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span>
    <span class="n">file_hash</span> <span class="o">=</span> <span class="n">hash_func</span><span class="p">()</span>

    <span class="n">CHUNK_SIZE</span> <span class="o">=</span> <span class="mi">65536</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">CHUNK_SIZE</span><span class="p">)</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">file_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
            <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">CHUNK_SIZE</span><span class="p">)</span>

    <span class="n">wrapped</span> <span class="o">=</span> <span class="n">multihash</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">file_hash</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span> <span class="s2">&quot;sha2-256&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">create_cid_digest</span><span class="p">(</span><span class="n">digest</span><span class="o">=</span><span class="n">wrapped</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="n">codec</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.hashing.create_cid_digest" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_cid_digest</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span></code>


<a href="#kiara.utils.hashing.create_cid_digest" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/hashing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_cid_digest</span><span class="p">(</span>
    <span class="n">digest</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">BytesLike</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Multihash</span><span class="p">],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BytesLike</span><span class="p">]]</span>
    <span class="p">],</span>
    <span class="n">codec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Multicodec</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;raw&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CID</span><span class="p">:</span>

    <span class="n">cid</span> <span class="o">=</span> <span class="n">CID</span><span class="p">(</span><span class="s2">&quot;base58btc&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="n">digest</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cid</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.jupyter" class="doc doc-heading">
        <code>jupyter</code>



<a href="#kiara.utils.jupyter" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.jupyter.create_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_image</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code>


<a href="#kiara.utils.jupyter.create_image" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/jupyter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_image</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pygraphviz</span> <span class="k">as</span> <span class="nn">pgv</span>  <span class="c1"># noqa</span>
    <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa</span>
        <span class="k">return</span> <span class="s2">&quot;pygraphviz not available, please install it manually into the current virtualenv&quot;</span>

    <span class="c1"># graph = nx.relabel_nodes(graph, lambda x: hash(x))</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">nx_agraph</span><span class="o">.</span><span class="n">to_agraph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

    <span class="n">G</span><span class="o">.</span><span class="n">node_attr</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span>
    <span class="c1"># G.unflatten().layout(prog=&quot;dot&quot;)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s2">&quot;dot&quot;</span><span class="p">)</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.jupyter.graph_to_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">graph_to_image</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">return_bytes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.jupyter.graph_to_image" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/jupyter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">graph_to_image</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">return_bytes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">create_image</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">b</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Image</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.jupyter.save_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_image</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.jupyter.save_image" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/jupyter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_image</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

    <span class="n">graph_b</span> <span class="o">=</span> <span class="n">create_image</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graph_b</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.metadata" class="doc doc-heading">
        <code>metadata</code>



<a href="#kiara.utils.metadata" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.metadata.find_metadata_models" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_metadata_models</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">only_for_package</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.metadata.find_metadata_models" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/metadata.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_metadata_models</span><span class="p">(</span>
    <span class="n">alias</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">only_for_package</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MetadataTypeClassesInfo</span><span class="p">:</span>

    <span class="n">model_registry</span> <span class="o">=</span> <span class="n">ModelRegistry</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
    <span class="n">_group</span> <span class="o">=</span> <span class="n">model_registry</span><span class="o">.</span><span class="n">get_models_of_type</span><span class="p">(</span><span class="n">ValueMetadata</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="n">classes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">ValueMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">model_id</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">_group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">classes</span><span class="p">[</span><span class="n">model_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">python_class</span><span class="o">.</span><span class="n">get_class</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

    <span class="n">group</span><span class="p">:</span> <span class="n">MetadataTypeClassesInfo</span> <span class="o">=</span> <span class="n">MetadataTypeClassesInfo</span><span class="o">.</span><span class="n">create_from_type_items</span><span class="p">(</span><span class="n">group_alias</span><span class="o">=</span><span class="n">alias</span><span class="p">,</span> <span class="o">**</span><span class="n">classes</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">only_for_package</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;package&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">only_for_package</span><span class="p">:</span>
                <span class="n">temp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>

        <span class="n">group</span> <span class="o">=</span> <span class="n">MetadataTypeClassesInfo</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span>
            <span class="n">group_id</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">instance_id</span><span class="p">,</span> <span class="n">group_alias</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">group_alias</span><span class="p">,</span> <span class="n">item_infos</span><span class="o">=</span><span class="n">temp</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">group</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.models" class="doc doc-heading">
        <code>models</code>



<a href="#kiara.utils.models" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






<h4 id="kiara.utils.models-functions">Functions<a href="#kiara.utils.models-functions" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.models.assemble_subcomponent_tree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assemble_subcomponent_tree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>


<a href="#kiara.utils.models.assemble_subcomponent_tree" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/models.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">assemble_subcomponent_tree</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s2">&quot;KiaraModel&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">assemble_tree</span><span class="p">(</span><span class="n">info_model</span><span class="p">:</span> <span class="n">KiaraModel</span><span class="p">,</span> <span class="n">current_node_id</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">current_node_id</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">info_model</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
        <span class="n">scn</span> <span class="o">=</span> <span class="n">info_model</span><span class="o">.</span><span class="n">subcomponent_keys</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scn</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">child_path</span> <span class="ow">in</span> <span class="n">scn</span><span class="p">:</span>
            <span class="n">child_obj</span> <span class="o">=</span> <span class="n">info_model</span><span class="o">.</span><span class="n">get_subcomponent</span><span class="p">(</span><span class="n">child_path</span><span class="p">)</span>
            <span class="n">new_node_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_node_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">child_path</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">current_node_id</span><span class="p">,</span> <span class="n">new_node_id</span><span class="p">)</span>
            <span class="n">assemble_tree</span><span class="p">(</span><span class="n">child_obj</span><span class="p">,</span> <span class="n">new_node_id</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">assemble_tree</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">KIARA_DEFAULT_ROOT_NODE_ID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.models.create_pydantic_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_pydantic_model</span><span class="p">(</span><span class="n">model_cls</span><span class="p">,</span> <span class="n">_use_pydantic_construct</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">field_values</span><span class="p">)</span></code>


<a href="#kiara.utils.models.create_pydantic_model" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/models.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_pydantic_model</span><span class="p">(</span>
    <span class="n">model_cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">],</span>
    <span class="n">_use_pydantic_construct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">PYDANTIC_USE_CONSTRUCT</span><span class="p">,</span>
    <span class="o">**</span><span class="n">field_values</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="n">_use_pydantic_construct</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">model_cls</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="o">**</span><span class="n">field_values</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model_cls</span><span class="p">(</span><span class="o">**</span><span class="n">field_values</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.models.get_subcomponent_from_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_subcomponent_from_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>


<a href="#kiara.utils.models.get_subcomponent_from_model" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return subcomponents of a model under a specified path.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/models.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_subcomponent_from_model</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s2">&quot;KiaraModel&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;KiaraModel&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return subcomponents of a model under a specified path.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">first_token</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_subcomponent</span><span class="p">(</span><span class="n">first_token</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_subcomponent</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;__custom_root_type__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">__custom_root_type__</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="p">[</span><span class="n">path</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matches</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">):</span>
                        <span class="n">rest</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>  <span class="c1"># noqa</span>
                        <span class="n">matches</span><span class="p">[</span><span class="n">rest</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No child models under &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
                    <span class="c1"># subcomponent_group = KiaraModelGroup.create_from_child_models(**matches)</span>
                    <span class="c1"># return subcomponent_group</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__fields__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No subcomponent for key &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; in model: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">instance_id</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.models.module_config_is_empty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">module_config_is_empty</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>


<a href="#kiara.utils.models.module_config_is_empty" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/models.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">module_config_is_empty</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>

    <span class="n">c</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;defaults&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">constants</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;constants&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">constants</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">c</span> <span class="k">else</span> <span class="kc">True</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.models.retrieve_data_subcomponent_keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_data_subcomponent_keys</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>


<a href="#kiara.utils.models.retrieve_data_subcomponent_keys" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/models.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_data_subcomponent_keys</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;__custom_root_type__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">__custom_root_type__</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__root__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__fields__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">_type</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">__fields__</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">type_</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
                <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">matches</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log_message</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No subcomponents retrieval supported for data of type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.operations" class="doc doc-heading">
        <code>operations</code>



<a href="#kiara.utils.operations" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.operations.create_operation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_operation</span><span class="p">(</span><span class="n">module_or_operation</span><span class="p">,</span> <span class="n">operation_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kiara</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.operations.create_operation" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/operations.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_operation</span><span class="p">(</span>
    <span class="n">module_or_operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">operation_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kiara</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Kiara&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Operation</span><span class="p">:</span>

    <span class="n">operation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Operation</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">kiara</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">kiara.context</span> <span class="kn">import</span> <span class="n">Kiara</span>

        <span class="n">kiara</span> <span class="o">=</span> <span class="n">Kiara</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">module_or_operation</span> <span class="ow">in</span> <span class="n">kiara</span><span class="o">.</span><span class="n">operation_registry</span><span class="o">.</span><span class="n">operation_ids</span><span class="p">:</span>

        <span class="n">operation</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">operation_registry</span><span class="o">.</span><span class="n">get_operation</span><span class="p">(</span><span class="n">module_or_operation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">operation_config</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Specified run target &#39;</span><span class="si">{</span><span class="n">module_or_operation</span><span class="si">}</span><span class="s2">&#39; is an operation, additional module configuration is not allowed.&quot;</span>
            <span class="p">)</span>

    <span class="k">elif</span> <span class="n">module_or_operation</span> <span class="ow">in</span> <span class="n">kiara</span><span class="o">.</span><span class="n">module_type_names</span><span class="p">:</span>

        <span class="n">manifest</span> <span class="o">=</span> <span class="n">Manifest</span><span class="p">(</span>
            <span class="n">module_type</span><span class="o">=</span><span class="n">module_or_operation</span><span class="p">,</span> <span class="n">module_config</span><span class="o">=</span><span class="n">operation_config</span>
        <span class="p">)</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">create_module</span><span class="p">(</span><span class="n">manifest</span><span class="o">=</span><span class="n">manifest</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">Operation</span><span class="o">.</span><span class="n">create_from_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">module_or_operation</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">get_data_from_file</span><span class="p">(</span><span class="n">module_or_operation</span><span class="p">)</span>
        <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pipeline_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pipeline_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">module_or_operation</span><span class="p">)</span>

        <span class="c1"># self._defaults = data.pop(&quot;inputs&quot;, {})</span>

        <span class="n">execution_context</span> <span class="o">=</span> <span class="n">ExecutionContext</span><span class="p">(</span>
            <span class="n">pipeline_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">module_or_operation</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">pipeline_config</span> <span class="o">=</span> <span class="n">PipelineConfig</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span>
            <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">kiara</span><span class="o">=</span><span class="n">kiara</span><span class="p">,</span>
            <span class="n">execution_context</span><span class="o">=</span><span class="n">execution_context</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">manifest</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">create_manifest</span><span class="p">(</span><span class="s2">&quot;pipeline&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">pipeline_config</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">create_module</span><span class="p">(</span><span class="n">manifest</span><span class="o">=</span><span class="n">manifest</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">Operation</span><span class="o">.</span><span class="n">create_from_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">pipeline_config</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t assemble operation, invalid operation/module name: </span><span class="si">{</span><span class="n">module_or_operation</span><span class="si">}</span><span class="s2">. Must be registered module or operation name, or file.&quot;</span>
        <span class="p">)</span>
        <span class="c1"># manifest = Manifest(</span>
        <span class="c1">#     module_type=module_or_operation,</span>
        <span class="c1">#     module_config=self._operation_config,</span>
        <span class="c1"># )</span>
        <span class="c1"># module = self._kiara.create_module(manifest=manifest)</span>
        <span class="c1"># operation = Operation.create_from_module(module=module)</span>

    <span class="k">if</span> <span class="n">operation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">merged</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kiara</span><span class="o">.</span><span class="n">module_type_names</span><span class="p">)</span>
        <span class="n">merged</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kiara</span><span class="o">.</span><span class="n">operation_registry</span><span class="o">.</span><span class="n">operation_ids</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">NoSuchExecutionTargetException</span><span class="p">(</span>
            <span class="n">selected_target</span><span class="o">=</span><span class="n">module_or_operation</span><span class="p">,</span>
            <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Invalid run target name &#39;</span><span class="si">{</span><span class="n">module_or_operation</span><span class="si">}</span><span class="s2">&#39;. Must be a path to a pipeline file, or one of the available modules/operations.&quot;</span><span class="p">,</span>
            <span class="n">available_targets</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">merged</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">operation</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.operations.filter_operations" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_operations</span><span class="p">(</span><span class="n">kiara</span><span class="p">,</span> <span class="n">pkg_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">operations</span><span class="p">)</span></code>


<a href="#kiara.utils.operations.filter_operations" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/operations.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_operations</span><span class="p">(</span>
    <span class="n">kiara</span><span class="p">:</span> <span class="s2">&quot;Kiara&quot;</span><span class="p">,</span> <span class="n">pkg_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">operations</span><span class="p">:</span> <span class="s2">&quot;Operation&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OperationGroupInfo</span><span class="p">:</span>

    <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OperationInfo</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># op_infos = kiara.operation_registry.get_context_metadata(only_for_package=pkg_name)</span>
    <span class="n">modules</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">module_registry</span><span class="o">.</span><span class="n">get_context_metadata</span><span class="p">(</span><span class="n">only_for_package</span><span class="o">=</span><span class="n">pkg_name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">op_id</span><span class="p">,</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">operations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">module_type_name</span> <span class="o">!=</span> <span class="s2">&quot;pipeline&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">module_type_name</span> <span class="ow">in</span> <span class="n">modules</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">op_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">OperationInfo</span><span class="o">.</span><span class="n">create_from_operation</span><span class="p">(</span>
                    <span class="n">kiara</span><span class="o">=</span><span class="n">kiara</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="n">op</span>
                <span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">package</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s2">&quot;package&quot;</span><span class="p">,</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pkg_name</span> <span class="ow">or</span> <span class="p">(</span><span class="n">package</span> <span class="ow">and</span> <span class="n">package</span> <span class="o">==</span> <span class="n">pkg_name</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">op_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">OperationInfo</span><span class="o">.</span><span class="n">create_from_operation</span><span class="p">(</span>
                    <span class="n">kiara</span><span class="o">=</span><span class="n">kiara</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="n">op</span>
                <span class="p">)</span>

        <span class="c1"># opt_types = kiara.operation_registry.find_all_operation_types(op_id)</span>
        <span class="c1"># match = False</span>
        <span class="c1"># for ot in opt_types:</span>
        <span class="c1">#     if ot in op_infos.keys():</span>
        <span class="c1">#         match = True</span>
        <span class="c1">#         break</span>
        <span class="c1">#</span>
        <span class="c1"># if match:</span>
        <span class="c1">#     result[op_id] = OperationInfo.create_from_operation(</span>
        <span class="c1">#         kiara=kiara, operation=op</span>
        <span class="c1">#     )</span>

    <span class="k">return</span> <span class="n">OperationGroupInfo</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">item_infos</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.output" class="doc doc-heading">
        <code>output</code>



<a href="#kiara.utils.output" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.output.log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log</span></code>


<a href="#kiara.utils.output.log" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>


<h4 id="kiara.utils.output-classes">Classes<a href="#kiara.utils.output-classes" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.output.ArrowTabularWrap" class="doc doc-heading">
        <code>
ArrowTabularWrap            (<a class="autorefs autorefs-internal" title="kiara.utils.output.TabularWrap" href="../output/#kiara.utils.output.TabularWrap">TabularWrap</a>)
        </code>



<a href="#kiara.utils.output.ArrowTabularWrap" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ArrowTabularWrap</span><span class="p">(</span><span class="n">TabularWrap</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;ArrowTable&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="p">:</span> <span class="s2">&quot;ArrowTable&quot;</span> <span class="o">=</span> <span class="n">table</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">column_names</span>

    <span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">num_rows</span>

    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.ArrowTabularWrap.retrieve_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.ArrowTabularWrap.retrieve_column_names" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">column_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.ArrowTabularWrap.retrieve_number_of_rows" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.ArrowTabularWrap.retrieve_number_of_rows" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">num_rows</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.ArrowTabularWrap.slice" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.ArrowTabularWrap.slice" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.ArrowTabularWrap.to_pydict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.ArrowTabularWrap.to_pydict" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.output.DictTabularWrap" class="doc doc-heading">
        <code>
DictTabularWrap            (<a class="autorefs autorefs-internal" title="kiara.utils.output.TabularWrap" href="../output/#kiara.utils.output.TabularWrap">TabularWrap</a>)
        </code>



<a href="#kiara.utils.output.DictTabularWrap" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DictTabularWrap</span><span class="p">(</span><span class="n">TabularWrap</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TabularWrap&quot;</span><span class="p">:</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">end</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">DictTabularWrap</span><span class="p">({</span><span class="n">cn</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">offset</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">length</span><span class="p">:</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">length</span>
                    <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
                        <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DictTabularWrap</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.DictTabularWrap.retrieve_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.DictTabularWrap.retrieve_column_names" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.DictTabularWrap.retrieve_number_of_rows" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.DictTabularWrap.retrieve_number_of_rows" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.DictTabularWrap.slice" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.DictTabularWrap.slice" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TabularWrap&quot;</span><span class="p">:</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">end</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">DictTabularWrap</span><span class="p">({</span><span class="n">cn</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">offset</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">length</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">length</span>
                <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">DictTabularWrap</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.DictTabularWrap.to_pydict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.DictTabularWrap.to_pydict" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.output.OutputDetails" class="doc doc-heading">
        <code>
OutputDetails            (<span title="pydantic.main.BaseModel">BaseModel</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a href="#kiara.utils.output.OutputDetails" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OutputDetails</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;format=</span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;=&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;format=</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">output_details_dict</span> <span class="o">=</span> <span class="n">dict_from_cli_args</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Can&#39;t parse output detail config: invalid input type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>

        <span class="n">output_details</span> <span class="o">=</span> <span class="n">OutputDetails</span><span class="p">(</span><span class="o">**</span><span class="n">output_details_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_details</span>

    <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The output format.&quot;</span><span class="p">)</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The output target.&quot;</span><span class="p">)</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Output configuration.&quot;</span><span class="p">,</span> <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span>
    <span class="p">)</span>

    <span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_set_defaults</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>

        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="s2">&quot;terminal&quot;</span><span class="p">)</span>
        <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;terminal&quot;</span><span class="p">:</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;terminal&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                    <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ext</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">]:</span>
                        <span class="nb">format</span> <span class="o">=</span> <span class="n">ext</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="p">)}</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h6 id="kiara.utils.output.OutputDetails-attributes">Attributes<a href="#kiara.utils.output.OutputDetails-attributes" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.output.OutputDetails.config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara.utils.output.OutputDetails.config" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Output configuration.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.output.OutputDetails.format" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">format</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a href="#kiara.utils.output.OutputDetails.format" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>The output format.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.output.OutputDetails.target" class="doc doc-heading">
<code class="highlight language-python"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a href="#kiara.utils.output.OutputDetails.target" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>The output target.</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.OutputDetails.from_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a href="#kiara.utils.output.OutputDetails.from_data" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;format=</span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;=&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;format=</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="n">output_details_dict</span> <span class="o">=</span> <span class="n">dict_from_cli_args</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t parse output detail config: invalid input type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="n">output_details</span> <span class="o">=</span> <span class="n">OutputDetails</span><span class="p">(</span><span class="o">**</span><span class="n">output_details_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_details</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.output.RenderConfig" class="doc doc-heading">
        <code>
RenderConfig            (<span title="pydantic.main.BaseModel">BaseModel</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a href="#kiara.utils.output.RenderConfig" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RenderConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>

    <span class="n">render_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The output format.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;terminal&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h6 id="kiara.utils.output.RenderConfig-attributes">Attributes<a href="#kiara.utils.output.RenderConfig-attributes" class="headerlink" title="Permanent link">&para;</a></h6>

  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.output.RenderConfig.render_format" class="doc doc-heading">
<code class="highlight language-python"><span class="n">render_format</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a href="#kiara.utils.output.RenderConfig.render_format" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>The output format.</p>
    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.output.SqliteTabularWrap" class="doc doc-heading">
        <code>
SqliteTabularWrap            (<a class="autorefs autorefs-internal" title="kiara.utils.output.TabularWrap" href="../output/#kiara.utils.output.TabularWrap">TabularWrap</a>)
        </code>



<a href="#kiara.utils.output.SqliteTabularWrap" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SqliteTabularWrap</span><span class="p">(</span><span class="n">TabularWrap</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine</span><span class="p">:</span> <span class="s2">&quot;Engine&quot;</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="p">:</span> <span class="n">Engine</span> <span class="o">=</span> <span class="n">engine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">table_name</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT count(*) from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="n">num_rows</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">num_rows</span>

    <span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

        <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">inspect</span>

        <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span>
        <span class="n">inspector</span> <span class="o">=</span> <span class="n">inspect</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">get_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TabularWrap&quot;</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>

        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">length</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> LIMIT </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> LIMIT </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> OFFSET </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
            <span class="n">result_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
                <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">):</span>
                    <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">DictTabularWrap</span><span class="p">(</span><span class="n">result_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>

        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
            <span class="n">result_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
                <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">):</span>
                    <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result_dict</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.SqliteTabularWrap.retrieve_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.SqliteTabularWrap.retrieve_column_names" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

    <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">inspect</span>

    <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span>
    <span class="n">inspector</span> <span class="o">=</span> <span class="n">inspect</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">get_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.SqliteTabularWrap.retrieve_number_of_rows" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.SqliteTabularWrap.retrieve_number_of_rows" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT count(*) from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">num_rows</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.SqliteTabularWrap.slice" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.SqliteTabularWrap.slice" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TabularWrap&quot;</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>

    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">length</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> LIMIT </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> LIMIT </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> OFFSET </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
        <span class="n">result_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
            <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">):</span>
                <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">DictTabularWrap</span><span class="p">(</span><span class="n">result_dict</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.SqliteTabularWrap.to_pydict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.SqliteTabularWrap.to_pydict" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>

    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_name</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
        <span class="n">result_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
            <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">):</span>
                <span class="n">result_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">result_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="kiara.utils.output.TabularWrap" class="doc doc-heading">
        <code>
TabularWrap            (<span title="abc.ABC">ABC</span>)
        </code>



<a href="#kiara.utils.output.TabularWrap" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TabularWrap</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TabularWrap&quot;</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">pretty_print</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rows_head</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">rows_tail</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_row_height</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_cell_length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_table_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RenderableType</span><span class="p">:</span>

        <span class="n">rich_table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">,</span> <span class="n">show_header</span><span class="o">=</span><span class="n">show_table_header</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>
            <span class="n">rich_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>

        <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">rows_head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">rows_head</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rows_head</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">rows_head</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">():</span>
                <span class="n">rows_head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>
                <span class="n">rows_tail</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">rows_tail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rows_head</span> <span class="o">+</span> <span class="n">rows_tail</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                    <span class="n">rows_head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>
                    <span class="n">rows_tail</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">rows_head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows_head</span><span class="p">)</span>
            <span class="n">num_rows</span> <span class="o">=</span> <span class="n">rows_head</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">num_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>

        <span class="n">table_dict</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">cell_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">max_row_height</span> <span class="ow">and</span> <span class="n">max_row_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="p">:</span>
                    <span class="n">lines</span> <span class="o">=</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_row_height</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">max_row_height</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_row_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;..&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">half</span><span class="p">:]</span>
                    <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">max_cell_length</span> <span class="ow">and</span> <span class="n">max_cell_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_cell_length</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_cell_length</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
                        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_str</span><span class="p">)</span>

            <span class="n">rich_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">num_split_rows</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_split_rows</span><span class="p">):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
                <span class="n">rich_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rows_head</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rows_tail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rows_tail</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rows_tail</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span> <span class="o">-</span> <span class="n">rows_tail</span><span class="p">)</span>
                <span class="n">table_dict</span> <span class="o">=</span> <span class="n">tail</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">):</span>

                    <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>

                        <span class="n">cell</span> <span class="o">=</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">cell_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">max_row_height</span> <span class="ow">and</span> <span class="n">max_row_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="p">:</span>
                            <span class="n">lines</span> <span class="o">=</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_row_height</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">max_row_height</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                    <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                                    <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;..&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">half</span><span class="p">:]</span>
                            <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">max_cell_length</span> <span class="ow">and</span> <span class="n">max_cell_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>

                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_cell_length</span><span class="p">:</span>
                                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:(</span><span class="n">max_cell_length</span><span class="p">)]</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
                                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                            <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

                        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_str</span><span class="p">)</span>

                    <span class="n">rich_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rich_table</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.output.TabularWrap.column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">column_names</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#kiara.utils.output.TabularWrap.column_names" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="kiara.utils.output.TabularWrap.num_rows" class="doc doc-heading">
<code class="highlight language-python"><span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#kiara.utils.output.TabularWrap.num_rows" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.TabularWrap.pretty_print" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pretty_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows_head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows_tail</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_row_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_cell_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_table_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#kiara.utils.output.TabularWrap.pretty_print" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pretty_print</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">rows_head</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rows_tail</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_row_height</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_cell_length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_table_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RenderableType</span><span class="p">:</span>

    <span class="n">rich_table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">,</span> <span class="n">show_header</span><span class="o">=</span><span class="n">show_table_header</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>
        <span class="n">rich_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>

    <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">rows_head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">rows_head</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rows_head</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">rows_head</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">():</span>
            <span class="n">rows_head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>
            <span class="n">rows_tail</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">rows_tail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rows_head</span> <span class="o">+</span> <span class="n">rows_tail</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="n">rows_head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>
                <span class="n">rows_tail</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num_split_rows</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">rows_head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows_head</span><span class="p">)</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="n">rows_head</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span>

    <span class="n">table_dict</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">cell_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">max_row_height</span> <span class="ow">and</span> <span class="n">max_row_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_row_height</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">max_row_height</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_row_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;..&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">half</span><span class="p">:]</span>
                <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">max_cell_length</span> <span class="ow">and</span> <span class="n">max_cell_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_cell_length</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_cell_length</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_str</span><span class="p">)</span>

        <span class="n">rich_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num_split_rows</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_split_rows</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
            <span class="n">rich_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rows_head</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rows_tail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rows_tail</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rows_tail</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retrieve_number_of_rows</span><span class="p">()</span> <span class="o">-</span> <span class="n">rows_tail</span><span class="p">)</span>
            <span class="n">table_dict</span> <span class="o">=</span> <span class="n">tail</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">):</span>

                <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_column_names</span><span class="p">():</span>

                    <span class="n">cell</span> <span class="o">=</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">cell_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">max_row_height</span> <span class="ow">and</span> <span class="n">max_row_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="p">:</span>
                        <span class="n">lines</span> <span class="o">=</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_row_height</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">max_row_height</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                                <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;..&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">half</span><span class="p">:]</span>
                        <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">max_cell_length</span> <span class="ow">and</span> <span class="n">max_cell_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">cell_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_cell_length</span><span class="p">:</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:(</span><span class="n">max_cell_length</span><span class="p">)]</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
                            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="n">cell_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_str</span><span class="p">)</span>

                <span class="n">rich_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rich_table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.TabularWrap.retrieve_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.TabularWrap.retrieve_column_names" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">retrieve_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.TabularWrap.retrieve_number_of_rows" class="doc doc-heading">
<code class="highlight language-python"><span class="n">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.TabularWrap.retrieve_number_of_rows" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">retrieve_number_of_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.TabularWrap.slice" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.TabularWrap.slice" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TabularWrap&quot;</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="kiara.utils.output.TabularWrap.to_pydict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#kiara.utils.output.TabularWrap.to_pydict" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>


<h4 id="kiara.utils.output-functions">Functions<a href="#kiara.utils.output-functions" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.create_pipeline_steps_tree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_pipeline_steps_tree</span><span class="p">(</span><span class="n">pipeline_structure</span><span class="p">,</span> <span class="n">pipeline_details</span><span class="p">)</span></code>


<a href="#kiara.utils.output.create_pipeline_steps_tree" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_pipeline_steps_tree</span><span class="p">(</span>
    <span class="n">pipeline_structure</span><span class="p">:</span> <span class="s2">&quot;PipelineStructure&quot;</span><span class="p">,</span> <span class="n">pipeline_details</span><span class="p">:</span> <span class="s2">&quot;PipelineDetails&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tree</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">kiara.models.module.pipeline</span> <span class="kn">import</span> <span class="n">StepStatus</span>

    <span class="n">steps</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s2">&quot;steps&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">stage</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pipeline_structure</span><span class="o">.</span><span class="n">processing_stages</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">stage_node</span> <span class="o">=</span> <span class="n">steps</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stage: [i]</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">[/i]&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">step_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">stage</span><span class="p">):</span>
            <span class="n">step_node</span> <span class="o">=</span> <span class="n">stage_node</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;step: [i]</span><span class="si">{</span><span class="n">step_id</span><span class="si">}</span><span class="s2">[/i]&quot;</span><span class="p">)</span>
            <span class="n">step_details</span> <span class="o">=</span> <span class="n">pipeline_details</span><span class="o">.</span><span class="n">step_states</span><span class="p">[</span><span class="n">step_id</span><span class="p">]</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">step_details</span><span class="o">.</span><span class="n">status</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">StepStatus</span><span class="o">.</span><span class="n">INPUTS_READY</span><span class="p">:</span>
                <span class="n">step_node</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;status: [yellow]inputs ready[/yellow]&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">StepStatus</span><span class="o">.</span><span class="n">RESULTS_READY</span><span class="p">:</span>
                <span class="n">step_node</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;status: [green]results ready[/green]&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">invalid_node</span> <span class="o">=</span> <span class="n">step_node</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;status: [red]inputs invalid[/red]&quot;</span><span class="p">)</span>
                <span class="n">invalid</span> <span class="o">=</span> <span class="n">step_details</span><span class="o">.</span><span class="n">invalid_details</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">invalid</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">invalid_node</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[i]</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">[/i]: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">steps</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.create_renderable_from_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_renderable_from_values</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.create_renderable_from_values" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Create a renderable for this module configuration.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_renderable_from_values</span><span class="p">(</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RenderableType</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a renderable for this module configuration.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">render_format</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;render_format&quot;</span><span class="p">,</span> <span class="s2">&quot;terminal&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">render_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;terminal&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid render format: </span><span class="si">{</span><span class="n">render_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">show_pedigree</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_pedigree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">show_data</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_data&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">show_hash</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_hash&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1"># show_load_config = config.get(&quot;show_load_config&quot;, False)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">show_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">MINIMAL_DOUBLE_HEAD</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;value_id&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;data_type&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_hash</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;hash&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_pedigree</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;pedigree&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_data</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
        <span class="n">row</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RenderableType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">value_size</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">show_hash</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">value_hash</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_pedigree</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">pedigree</span> <span class="o">==</span> <span class="n">ORPHAN</span><span class="p">:</span>
                <span class="n">pedigree</span> <span class="o">=</span> <span class="s2">&quot;-- n/a --&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pedigree</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">pedigree</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pedigree</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_data</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_data_registry</span><span class="o">.</span><span class="n">pretty_print_data</span><span class="p">(</span>
                <span class="n">value_id</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">value_id</span><span class="p">,</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;terminal_renderable&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span>
            <span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># if show_load_config:</span>
        <span class="c1">#     load_config = value.retrieve_load_config()</span>
        <span class="c1">#     if load_config is None:</span>
        <span class="c1">#         load_config_str: RenderableType = &quot;-- not stored (yet) --&quot;</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         load_config_str = load_config.create_renderable()</span>
        <span class="c1">#     row.append(load_config_str)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.create_table_from_base_model_cls" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_table_from_base_model_cls</span><span class="p">(</span><span class="n">model_cls</span><span class="p">)</span></code>


<a href="#kiara.utils.output.create_table_from_base_model_cls" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_table_from_base_model_cls</span><span class="p">(</span><span class="n">model_cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]):</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">,</span> <span class="n">show_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Field&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Required&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Default&quot;</span><span class="p">)</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">model_cls</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model_cls</span><span class="o">.</span><span class="n">__fields__</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">p_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p_type</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="c1"># TODO: check &#39;anyOf&#39; keys</span>

        <span class="k">if</span> <span class="n">p_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p_type</span> <span class="o">=</span> <span class="s2">&quot;-- check source --&quot;</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_type</span><span class="p">)</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;yes&quot;</span> <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">required</span> <span class="k">else</span> <span class="s2">&quot;no&quot;</span><span class="p">)</span>
        <span class="n">default</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">default</span><span class="p">):</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">default</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">default</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">default</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.create_table_from_field_schemas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_table_from_field_schemas</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">_add_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">_add_required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">_show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_constants</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.create_table_from_field_schemas" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_table_from_field_schemas</span><span class="p">(</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;ValueSchema&quot;</span><span class="p">],</span>
    <span class="n">_add_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">_add_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">_show_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_constants</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RichTable</span><span class="p">:</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">,</span> <span class="n">show_header</span><span class="o">=</span><span class="n">_show_header</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;field name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s2">&quot;fold&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_add_required</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Required&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_add_default</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_constants</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Default / Constant&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Default&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">row</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RenderableType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">field_name</span><span class="p">,</span> <span class="n">schema</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">schema</span><span class="o">.</span><span class="n">doc</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">_add_required</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">is_required</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">req</span><span class="p">:</span>
                <span class="n">req_str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">default</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="kc">None</span><span class="p">,</span>
                    <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NO_VALUE</span><span class="p">,</span>
                    <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">req_str</span> <span class="o">=</span> <span class="s2">&quot;[b]yes[b]&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">req_str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">req_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">_add_default</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_constants</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">_constants</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">d</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[b]</span><span class="si">{</span><span class="n">_constants</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="si">}</span><span class="s2">[/b] (constant)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">default</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="kc">None</span><span class="p">,</span>
                    <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NO_VALUE</span><span class="p">,</span>
                    <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="s2">&quot;-- no default --&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.create_table_from_model_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_table_from_model_object</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">render_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude_fields</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.create_table_from_model_object" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_table_from_model_object</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">,</span>
    <span class="n">render_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_fields</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">model_cls</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">,</span> <span class="n">show_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Field&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">)</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">model_cls</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model_cls</span><span class="o">.</span><span class="n">__fields__</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">exclude_fields</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">exclude_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">p_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p_type</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="c1"># TODO: check &#39;anyOf&#39; keys</span>

        <span class="k">if</span> <span class="n">p_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p_type</span> <span class="o">=</span> <span class="s2">&quot;-- check source --&quot;</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_type</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extract_renderable</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">render_config</span><span class="o">=</span><span class="n">render_config</span><span class="p">))</span>

        <span class="n">desc</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.create_value_map_status_renderable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_value_map_status_renderable</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">render_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.create_value_map_status_renderable" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_value_map_status_renderable</span><span class="p">(</span>
    <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span>
    <span class="n">render_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RichTable</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">render_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">render_config</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">show_description</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">render_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_description&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">show_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">render_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_type&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">show_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">render_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_required&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">show_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">render_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_default&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">show_value_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">render_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_value_ids&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">,</span> <span class="n">show_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;field name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_type</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_description</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_required</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;required&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_default</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_value_ids</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;value id&quot;</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s2">&quot;fold&quot;</span><span class="p">)</span>

    <span class="n">invalid</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">check_invalid</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">fields</span><span class="p">:</span>
        <span class="n">field_order</span> <span class="o">=</span> <span class="n">fields</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">field_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">inputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">field_order</span><span class="p">:</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;ignore.field&quot;</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">,</span> <span class="n">available_fields</span><span class="o">=</span><span class="n">inputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">row</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RenderableType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">invalid</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[red]</span><span class="si">{</span><span class="n">invalid</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="si">}</span><span class="s2">[/red]&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;[green]valid[/green]&quot;</span><span class="p">)</span>

        <span class="n">value_schema</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">values_schema</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">show_type</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_description</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_schema</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_required</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">value_schema</span><span class="o">.</span><span class="n">is_required</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">req</span><span class="p">:</span>
                <span class="n">req_str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value_schema</span><span class="o">.</span><span class="n">default</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="kc">None</span><span class="p">,</span>
                    <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NO_VALUE</span><span class="p">,</span>
                    <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">req_str</span> <span class="o">=</span> <span class="s2">&quot;[b]yes[b]&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">req_str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">req_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_default</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">value_schema</span><span class="o">.</span><span class="n">default</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">default</span><span class="p">):</span>
                <span class="n">default_val</span> <span class="o">=</span> <span class="n">default</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">default_val</span> <span class="o">=</span> <span class="n">default</span>

            <span class="k">if</span> <span class="n">default_val</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span><span class="p">,</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NO_VALUE</span><span class="p">]:</span>
                <span class="n">default_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">default_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">default_val</span><span class="p">)</span>

            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">default_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_value_ids</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="n">field_name</span><span class="o">=</span><span class="n">field_name</span><span class="p">)</span><span class="o">.</span><span class="n">value_id</span><span class="p">))</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.output.extract_renderable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_renderable</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">render_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.output.extract_renderable" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Try to automatically find and extract or create an object that is renderable by the 'rich' library.</p>

        <details class="quote">
          <summary>Source code in <code>kiara/utils/output.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_renderable</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">render_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Try to automatically find and extract or create an object that is renderable by the &#39;rich&#39; library.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">render_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">render_config</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">render_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">render_config</span><span class="p">)</span>

    <span class="n">inline_models_as_json</span> <span class="o">=</span> <span class="n">render_config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;inline_models_as_json&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;create_renderable&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">create_renderable</span><span class="p">(</span><span class="o">**</span><span class="n">render_config</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">ConsoleRenderable</span><span class="p">,</span> <span class="n">RichCast</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">item</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inline_models_as_json</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">create_table_from_model_object</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inline_models_as_json</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">RichTable</span><span class="p">(</span><span class="n">show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Key&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">extract_renderable</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">render_config</span><span class="o">=</span><span class="n">render_config</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">table</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
            <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">orjson_dumps</span><span class="p">(</span>
            <span class="n">result</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_INDENT_2</span> <span class="o">|</span> <span class="n">orjson</span><span class="o">.</span><span class="n">OPT_NON_STR_KEYS</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="n">_all</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extract_renderable</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">rg</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="o">*</span><span class="n">_all</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.pipelines" class="doc doc-heading">
        <code>pipelines</code>



<a href="#kiara.utils.pipelines" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






<h4 id="kiara.utils.pipelines-functions">Functions<a href="#kiara.utils.pipelines-functions" class="headerlink" title="Permanent link">&para;</a></h4>

  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.pipelines.check_doc_sidecar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_doc_sidecar</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#kiara.utils.pipelines.check_doc_sidecar" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/pipelines.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_doc_sidecar</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">data</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="n">_doc</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;documentation&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_doc_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.md&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_doc_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">_doc_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">doc</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="s2">&quot;documentation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.pipelines.create_step_value_address" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_step_value_address</span><span class="p">(</span><span class="n">value_address_config</span><span class="p">,</span> <span class="n">default_field_name</span><span class="p">)</span></code>


<a href="#kiara.utils.pipelines.create_step_value_address" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/pipelines.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_step_value_address</span><span class="p">(</span>
    <span class="n">value_address_config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">default_field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;StepValueAddress&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_address_config</span><span class="p">,</span> <span class="n">StepValueAddress</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value_address_config</span>

    <span class="n">sub_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_address_config</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

        <span class="n">tokens</span> <span class="o">=</span> <span class="n">value_address_config</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">step_id</span> <span class="o">=</span> <span class="n">value_address_config</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">default_field_name</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">step_id</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">step_id</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sub_value</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_address_config</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>

        <span class="n">step_id</span> <span class="o">=</span> <span class="n">value_address_config</span><span class="p">[</span><span class="s2">&quot;step_id&quot;</span><span class="p">]</span>
        <span class="n">output_name</span> <span class="o">=</span> <span class="n">value_address_config</span><span class="p">[</span><span class="s2">&quot;value_name&quot;</span><span class="p">]</span>
        <span class="n">sub_value</span> <span class="o">=</span> <span class="n">value_address_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sub_value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid type for creating step value address: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value_address_config</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">sub_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_value</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sub_value</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; for sub_value (step_id: </span><span class="si">{</span><span class="n">step_id</span><span class="si">}</span><span class="s2">, value name: </span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">sub_value</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">input_link</span> <span class="o">=</span> <span class="n">StepValueAddress</span><span class="p">(</span>
        <span class="n">step_id</span><span class="o">=</span><span class="n">step_id</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="n">output_name</span><span class="p">,</span> <span class="n">sub_value</span><span class="o">=</span><span class="n">sub_value</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">input_link</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.pipelines.ensure_step_value_addresses" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ensure_step_value_addresses</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">default_field_name</span><span class="p">)</span></code>


<a href="#kiara.utils.pipelines.ensure_step_value_addresses" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/pipelines.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ensure_step_value_addresses</span><span class="p">(</span>
    <span class="n">link</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span> <span class="n">default_field_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;StepValueAddress&quot;</span><span class="p">]:</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)):</span>
        <span class="n">input_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StepValueAddress</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">create_step_value_address</span><span class="p">(</span>
                <span class="n">value_address_config</span><span class="o">=</span><span class="n">link</span><span class="p">,</span> <span class="n">default_field_name</span><span class="o">=</span><span class="n">default_field_name</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="n">input_links</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">link</span><span class="p">:</span>
            <span class="n">il</span> <span class="o">=</span> <span class="n">create_step_value_address</span><span class="p">(</span>
                <span class="n">value_address_config</span><span class="o">=</span><span class="n">o</span><span class="p">,</span> <span class="n">default_field_name</span><span class="o">=</span><span class="n">default_field_name</span>
            <span class="p">)</span>
            <span class="n">input_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">il</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t parse input map, invalid type for output: </span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">input_links</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.pipelines.get_pipeline_details_from_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_pipeline_details_from_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">module_type_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">base_module</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.pipelines.get_pipeline_details_from_path" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Load a pipeline description, save it's content, and determine it the pipeline base name.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>the path to the pipeline file</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>module_type_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>if specifies, overwrites any auto-detected or assigned pipeline name</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>base_module</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>overrides the base module the assembled pipeline module will be located in the python hierarchy</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>kiara/utils/pipelines.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_pipeline_details_from_path</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">module_type_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">base_module</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Load a pipeline description, save it&#39;s content, and determine it the pipeline base name.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        path: the path to the pipeline file</span>
<span class="sd">        module_type_name: if specifies, overwrites any auto-detected or assigned pipeline name</span>
<span class="sd">        base_module: overrides the base module the assembled pipeline module will be located in the python hierarchy</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t add pipeline description &#39;</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;: not a file&quot;</span>
        <span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data_from_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t register pipeline file &#39;</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;: no content.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">module_type_name</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">MODULE_TYPE_NAME_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="n">module_type_name</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not a dictionary type.&quot;</span><span class="p">)</span>

    <span class="c1"># filename = path.name</span>
    <span class="c1"># name = data.get(MODULE_TYPE_NAME_KEY, None)</span>
    <span class="c1"># if name is None:</span>
    <span class="c1">#     name = filename.split(&quot;.&quot;, maxsplit=1)[0]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">base_module</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;base_module&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_module</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.string_vars" class="doc doc-heading">
        <code>string_vars</code>



<a href="#kiara.utils.string_vars" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="kiara.utils.string_vars.log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log</span></code>


<a href="#kiara.utils.string_vars.log" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.string_vars.create_var_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_var_regex</span><span class="p">(</span><span class="n">delimiter_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter_end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.string_vars.create_var_regex" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/string_vars.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_var_regex</span><span class="p">(</span>
    <span class="n">delimiter_start</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">delimiter_end</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Pattern</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">delimiter_start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">delimiter_start</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">$</span><span class="se">\\</span><span class="s2">{&quot;</span>

    <span class="c1"># TODO: make this smarter</span>
    <span class="k">if</span> <span class="n">delimiter_end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">delimiter_end</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">}&quot;</span>

    <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">delimiter_start</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s*(.+?)</span><span class="se">\\</span><span class="s2">s*&quot;</span> <span class="o">+</span> <span class="n">delimiter_end</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">regex</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.string_vars.find_regex_matches_in_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_regex_matches_in_obj</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">current</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.string_vars.find_regex_matches_in_obj" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/string_vars.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_regex_matches_in_obj</span><span class="p">(</span>
    <span class="n">source_obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">regex</span><span class="p">:</span> <span class="n">Pattern</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

    <span class="k">if</span> <span class="n">current</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">current</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">source_obj</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">current</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">find_regex_matches_in_obj</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span> <span class="n">current</span><span class="o">=</span><span class="n">current</span><span class="p">)</span>
            <span class="n">find_regex_matches_in_obj</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span> <span class="n">current</span><span class="o">=</span><span class="n">current</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">source_obj</span><span class="p">)</span>
        <span class="n">current</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">source_obj</span><span class="p">:</span>
            <span class="n">find_regex_matches_in_obj</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span> <span class="n">current</span><span class="o">=</span><span class="n">current</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">current</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.string_vars.find_var_names_in_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_var_names_in_obj</span><span class="p">(</span><span class="n">template_obj</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter_end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.string_vars.find_var_names_in_obj" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/string_vars.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_var_names_in_obj</span><span class="p">(</span>
    <span class="n">template_obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Pattern</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delimiter_end</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">):</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">delimiter</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">create_var_regex</span><span class="p">(</span><span class="n">delimiter_start</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">delimiter_end</span><span class="o">=</span><span class="n">delimiter_end</span><span class="p">)</span>

    <span class="n">var_names</span> <span class="o">=</span> <span class="n">find_regex_matches_in_obj</span><span class="p">(</span><span class="n">template_obj</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">var_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.string_vars.replace_var_names_in_obj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_var_names_in_obj</span><span class="p">(</span><span class="n">template_obj</span><span class="p">,</span> <span class="n">repl_dict</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_missing_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.string_vars.replace_var_names_in_obj" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/string_vars.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">replace_var_names_in_obj</span><span class="p">(</span>
    <span class="n">template_obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">repl_dict</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Pattern</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delimiter_end</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ignore_missing_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">):</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">delimiter</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">create_var_regex</span><span class="p">(</span><span class="n">delimiter_start</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">delimiter_end</span><span class="o">=</span><span class="n">delimiter_end</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">template_obj</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">template_obj</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">template_obj</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">template_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">replace_var_names_in_obj</span><span class="p">(</span>
                <span class="n">template_obj</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
                <span class="n">repl_dict</span><span class="o">=</span><span class="n">repl_dict</span><span class="p">,</span>
                <span class="n">delimiter</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
                <span class="n">ignore_missing_keys</span><span class="o">=</span><span class="n">ignore_missing_keys</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">replace_var_names_in_obj</span><span class="p">(</span>
                <span class="n">template_obj</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                <span class="n">repl_dict</span><span class="o">=</span><span class="n">repl_dict</span><span class="p">,</span>
                <span class="n">delimiter</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
                <span class="n">ignore_missing_keys</span><span class="o">=</span><span class="n">ignore_missing_keys</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">template_obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">replace_var_names_in_string</span><span class="p">(</span>
            <span class="n">template_obj</span><span class="p">,</span>
            <span class="n">repl_dict</span><span class="o">=</span><span class="n">repl_dict</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
            <span class="n">ignore_missing_keys</span><span class="o">=</span><span class="n">ignore_missing_keys</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">template_obj</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">template_obj</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">replace_var_names_in_obj</span><span class="p">(</span>
                <span class="n">item</span><span class="p">,</span>
                <span class="n">repl_dict</span><span class="o">=</span><span class="n">repl_dict</span><span class="p">,</span>
                <span class="n">delimiter</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
                <span class="n">ignore_missing_keys</span><span class="o">=</span><span class="n">ignore_missing_keys</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">template_obj</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.string_vars.replace_var_names_in_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_var_names_in_string</span><span class="p">(</span><span class="n">template_string</span><span class="p">,</span> <span class="n">repl_dict</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">ignore_missing_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#kiara.utils.string_vars.replace_var_names_in_string" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/string_vars.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">replace_var_names_in_string</span><span class="p">(</span>
    <span class="n">template_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">repl_dict</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">Pattern</span><span class="p">,</span>
    <span class="n">ignore_missing_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">repl_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_missing_keys</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t insert variable &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39;. Key not in provided input values, available keys: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">repl_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">repl_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">template_string</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="kiara.utils.values" class="doc doc-heading">
        <code>values</code>



<a href="#kiara.utils.values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.values.augment_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">augment_values</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">schemas</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#kiara.utils.values.augment_values" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/values.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">augment_values</span><span class="p">(</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">schemas</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ValueSchema</span><span class="p">],</span>
    <span class="n">constants</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ValueSchema</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>

    <span class="c1"># TODO: check if extra fields were provided</span>

    <span class="k">if</span> <span class="n">constants</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid input: value provided for constant &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="n">values_new</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">constants</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">default</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NO_VALUE</span><span class="p">,</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="n">values_new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values_new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">schemas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">values_new</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Duplicate field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39;, this is most likely a bug.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">default</span> <span class="o">!=</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
                    <span class="n">values_new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">values_new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values_new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NOT_SET</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">NO_VALUE</span>
            <span class="n">values_new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">values_new</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.values.create_schema_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_schema_dict</span><span class="p">(</span><span class="n">schema_config</span><span class="p">)</span></code>


<a href="#kiara.utils.values.create_schema_dict" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/values.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_schema_dict</span><span class="p">(</span>
    <span class="n">schema_config</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">ValueSchema</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ValueSchema</span><span class="p">]:</span>

    <span class="n">invalid</span> <span class="o">=</span> <span class="n">check_valid_field_names</span><span class="p">(</span><span class="o">*</span><span class="n">schema_config</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t assemble schema because it contains invalid input field name(s) &#39;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">invalid</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;. Change the input schema to not contain any of the reserved keywords: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">INVALID_VALUE_NAMES</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ValueSchema</span><span class="p">):</span>
            <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="n">_v</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;doc&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_v</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">_v</span><span class="p">[</span><span class="s2">&quot;doc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_NO_DESC_VALUE</span>
            <span class="n">schema</span> <span class="o">=</span> <span class="n">ValueSchema</span><span class="p">(</span><span class="o">**</span><span class="n">_v</span><span class="p">)</span>

            <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">schema</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="vm">__class__</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid return type &#39;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&#39; for field &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; when trying to create schema.&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.values.extract_raw_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_raw_value</span><span class="p">(</span><span class="n">kiara</span><span class="p">,</span> <span class="n">value_id</span><span class="p">)</span></code>


<a href="#kiara.utils.values.extract_raw_value" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/values.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_raw_value</span><span class="p">(</span><span class="n">kiara</span><span class="p">:</span> <span class="s2">&quot;Kiara&quot;</span><span class="p">,</span> <span class="n">value_id</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">kiara</span><span class="o">.</span><span class="n">data_registry</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">value_id</span><span class="o">=</span><span class="n">value_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">pedigree</span> <span class="o">!=</span> <span class="n">ORPHAN</span><span class="p">:</span>
        <span class="c1"># TODO: find alias?</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&quot;value:</span><span class="si">{</span><span class="n">value_id</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">value_schema</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">list_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">data</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.values.extract_raw_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_raw_values</span><span class="p">(</span><span class="n">kiara</span><span class="p">,</span> <span class="o">**</span><span class="n">value_ids</span><span class="p">)</span></code>


<a href="#kiara.utils.values.extract_raw_values" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/values.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_raw_values</span><span class="p">(</span><span class="n">kiara</span><span class="p">:</span> <span class="s2">&quot;Kiara&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">value_ids</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value_id</span> <span class="ow">in</span> <span class="n">value_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">result</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_raw_value</span><span class="p">(</span><span class="n">kiara</span><span class="o">=</span><span class="n">kiara</span><span class="p">,</span> <span class="n">value_id</span><span class="o">=</span><span class="n">value_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="kiara.utils.values.overlay_constants_and_defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">overlay_constants_and_defaults</span><span class="p">(</span><span class="n">schemas</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">constants</span><span class="p">)</span></code>


<a href="#kiara.utils.values.overlay_constants_and_defaults" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>kiara/utils/values.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">overlay_constants_and_defaults</span><span class="p">(</span>
    <span class="n">schemas</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ValueSchema</span><span class="p">],</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">constants</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">):</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schemas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">default_value</span> <span class="o">=</span> <span class="n">defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">constant_value</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># value_to_test = None</span>
        <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">constant_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Module configuration error. Value &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; set in both &#39;constants&#39; and &#39;defaults&#39;, this is not allowed.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># TODO: perform validation for constants/defaults</span>

        <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">schemas</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default_value</span>

        <span class="k">if</span> <span class="n">constant_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">schemas</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">constant_value</span>
            <span class="n">schemas</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">is_constant</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">input_schemas</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">constants</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schemas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_constant</span><span class="p">:</span>
            <span class="n">constants</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">input_schemas</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">return</span> <span class="n">input_schemas</span><span class="p">,</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../render/pipeline/" class="md-footer__link md-footer__link--prev" aria-label="Previous: pipeline" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              pipeline
            </div>
          </div>
        </a>
      
      
        
        <a href="../class_loading/" class="md-footer__link md-footer__link--next" aria-label="Next: class_loading" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              class_loading
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      DHARPA project
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking"], "search": "../../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>